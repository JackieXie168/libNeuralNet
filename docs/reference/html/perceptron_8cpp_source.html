<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>OpenNN: perceptron.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.9 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    </ul>
  </div>
<h1>perceptron.cpp</h1><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/****************************************************************************************************************/</span>
<a name="l00002"></a>00002 <span class="comment">/*                                                                                                              */</span>
<a name="l00003"></a>00003 <span class="comment">/*   OpenNN: Open Neural Networks Library                                                                       */</span>
<a name="l00004"></a>00004 <span class="comment">/*   www.opennn.cimne.com                                                                                       */</span>
<a name="l00005"></a>00005 <span class="comment">/*                                                                                                              */</span>
<a name="l00006"></a>00006 <span class="comment">/*   P E R C E P T R O N   C L A S S                                                                            */</span>
<a name="l00007"></a>00007 <span class="comment">/*                                                                                                              */</span>
<a name="l00008"></a>00008 <span class="comment">/*   Roberto Lopez                                                                                              */</span>
<a name="l00009"></a>00009 <span class="comment">/*   International Center for Numerical Methods in Engineering (CIMNE)                                          */</span>
<a name="l00010"></a>00010 <span class="comment">/*   Technical University of Catalonia (UPC)                                                                    */</span>
<a name="l00011"></a>00011 <span class="comment">/*   Barcelona, Spain                                                                                           */</span>
<a name="l00012"></a>00012 <span class="comment">/*   E-mail: rlopez@cimne.upc.edu                                                                               */</span>
<a name="l00013"></a>00013 <span class="comment">/*                                                                                                              */</span>
<a name="l00014"></a>00014 <span class="comment">/****************************************************************************************************************/</span>
<a name="l00015"></a>00015 
<a name="l00016"></a>00016 <span class="comment">// System includes</span>
<a name="l00017"></a>00017 
<a name="l00018"></a>00018 <span class="preprocessor">#include &lt;iostream&gt;</span>
<a name="l00019"></a>00019 <span class="preprocessor">#include &lt;sstream&gt;</span>
<a name="l00020"></a>00020 <span class="preprocessor">#include &lt;cstdlib&gt;</span>
<a name="l00021"></a>00021 <span class="preprocessor">#include &lt;ctime&gt;</span>
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 <span class="comment">// OpenNN includes</span>
<a name="l00024"></a>00024 
<a name="l00025"></a>00025 <span class="preprocessor">#include "perceptron.h"</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include "../utilities/vector.h"</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include "../utilities/matrix.h"</span>
<a name="l00028"></a>00028 
<a name="l00029"></a>00029 <span class="keyword">namespace </span>OpenNN
<a name="l00030"></a>00030 {
<a name="l00031"></a>00031 
<a name="l00036"></a>00036         
<a name="l00037"></a><a class="code" href="class_open_n_n_1_1_perceptron.html#ebec50f527a9e392c3a3850edbd4185b">00037</a> <a class="code" href="class_open_n_n_1_1_perceptron.html#ebec50f527a9e392c3a3850edbd4185b">Perceptron::Perceptron</a>(<span class="keywordtype">void</span>)
<a name="l00038"></a>00038 {
<a name="l00039"></a>00039    <span class="keyword">set</span>();
<a name="l00040"></a>00040 }
<a name="l00041"></a>00041 
<a name="l00042"></a>00042 
<a name="l00049"></a>00049 
<a name="l00050"></a><a class="code" href="class_open_n_n_1_1_perceptron.html#57039e8b579bf9532d996dec8f7331c4">00050</a> <a class="code" href="class_open_n_n_1_1_perceptron.html#ebec50f527a9e392c3a3850edbd4185b">Perceptron::Perceptron</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&amp; new_inputs_number)
<a name="l00051"></a>00051 {
<a name="l00052"></a>00052    <span class="keyword">set</span>(new_inputs_number);
<a name="l00053"></a>00053 }
<a name="l00054"></a>00054 
<a name="l00055"></a>00055 
<a name="l00061"></a>00061 
<a name="l00062"></a><a class="code" href="class_open_n_n_1_1_perceptron.html#fca563b36e5e9dd615b53bf7f57fb264">00062</a> <a class="code" href="class_open_n_n_1_1_perceptron.html#ebec50f527a9e392c3a3850edbd4185b">Perceptron::Perceptron</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&amp; new_inputs_number, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; new_parameters_value)
<a name="l00063"></a>00063 {
<a name="l00064"></a>00064    <span class="keyword">set</span>(new_inputs_number, new_parameters_value);
<a name="l00065"></a>00065 }
<a name="l00066"></a>00066 
<a name="l00067"></a>00067 
<a name="l00071"></a>00071 
<a name="l00072"></a><a class="code" href="class_open_n_n_1_1_perceptron.html#d09bdcb61c8939deecc494e9b4044ede">00072</a> <a class="code" href="class_open_n_n_1_1_perceptron.html#ebec50f527a9e392c3a3850edbd4185b">Perceptron::Perceptron</a>(<span class="keyword">const</span> <a class="code" href="class_open_n_n_1_1_perceptron.html">Perceptron</a>&amp; other_perceptron)
<a name="l00073"></a>00073 {
<a name="l00074"></a>00074    <span class="keyword">set</span>(other_perceptron);
<a name="l00075"></a>00075 }
<a name="l00076"></a>00076 
<a name="l00077"></a>00077 
<a name="l00080"></a>00080 
<a name="l00081"></a><a class="code" href="class_open_n_n_1_1_perceptron.html#9c53157489b306a4bc6c77b39d7407ae">00081</a> <a class="code" href="class_open_n_n_1_1_perceptron.html#9c53157489b306a4bc6c77b39d7407ae">Perceptron::~Perceptron</a>(<span class="keywordtype">void</span>)
<a name="l00082"></a>00082 {
<a name="l00083"></a>00083 }
<a name="l00084"></a>00084 
<a name="l00085"></a>00085 
<a name="l00086"></a>00086 <span class="comment">// ASSIGNMENT OPERATOR</span>
<a name="l00087"></a>00087 
<a name="l00091"></a>00091 
<a name="l00092"></a><a class="code" href="class_open_n_n_1_1_perceptron.html#f855f399184d360554654866593543c9">00092</a> <a class="code" href="class_open_n_n_1_1_perceptron.html">Perceptron</a>&amp; <a class="code" href="class_open_n_n_1_1_perceptron.html#f855f399184d360554654866593543c9">Perceptron::operator=</a>(<span class="keyword">const</span> <a class="code" href="class_open_n_n_1_1_perceptron.html">Perceptron</a>&amp; other_perceptron)
<a name="l00093"></a>00093 {
<a name="l00094"></a>00094    <span class="keywordflow">if</span>(<span class="keyword">this</span> != &amp;other_perceptron) 
<a name="l00095"></a>00095    {
<a name="l00096"></a>00096       bias = other_perceptron.bias;
<a name="l00097"></a>00097    
<a name="l00098"></a>00098       synaptic_weights = other_perceptron.synaptic_weights;
<a name="l00099"></a>00099 
<a name="l00100"></a>00100       activation_function = other_perceptron.activation_function;
<a name="l00101"></a>00101 
<a name="l00102"></a>00102       display = other_perceptron.display;
<a name="l00103"></a>00103    }
<a name="l00104"></a>00104 
<a name="l00105"></a>00105    <span class="keywordflow">return</span>(*<span class="keyword">this</span>);
<a name="l00106"></a>00106 }
<a name="l00107"></a>00107 
<a name="l00108"></a>00108 
<a name="l00109"></a>00109 <span class="comment">// EQUAL TO OPERATOR</span>
<a name="l00110"></a>00110 
<a name="l00111"></a>00111 <span class="comment">// bool operator == (const Perceptron&amp;) const method</span>
<a name="l00112"></a>00112 
<a name="l00117"></a>00117 
<a name="l00118"></a><a class="code" href="class_open_n_n_1_1_perceptron.html#d5898ae6a14aa0e8d24c312f97fb9162">00118</a> <span class="keywordtype">bool</span> <a class="code" href="class_open_n_n_1_1_perceptron.html#d5898ae6a14aa0e8d24c312f97fb9162">Perceptron::operator == </a>(<span class="keyword">const</span> <a class="code" href="class_open_n_n_1_1_perceptron.html">Perceptron</a>&amp; other_perceptron)<span class="keyword"> const</span>
<a name="l00119"></a>00119 <span class="keyword"></span>{
<a name="l00120"></a>00120    <span class="keywordflow">if</span>(bias == other_perceptron.bias
<a name="l00121"></a>00121    &amp;&amp; synaptic_weights == other_perceptron.synaptic_weights
<a name="l00122"></a>00122    &amp;&amp; activation_function == other_perceptron.activation_function
<a name="l00123"></a>00123    &amp;&amp; display == other_perceptron.display)
<a name="l00124"></a>00124    {
<a name="l00125"></a>00125       <span class="keywordflow">return</span>(<span class="keyword">true</span>);
<a name="l00126"></a>00126    }
<a name="l00127"></a>00127    <span class="keywordflow">else</span>
<a name="l00128"></a>00128    {
<a name="l00129"></a>00129       <span class="keywordflow">return</span>(<span class="keyword">false</span>);
<a name="l00130"></a>00130    }
<a name="l00131"></a>00131 }
<a name="l00132"></a>00132 
<a name="l00133"></a>00133 
<a name="l00134"></a>00134 <span class="comment">// METHODS</span>
<a name="l00135"></a>00135 
<a name="l00136"></a>00136 <span class="comment">// const ActivationFunction&amp; get_activation_function(void) const method</span>
<a name="l00137"></a>00137 
<a name="l00139"></a>00139 
<a name="l00140"></a><a class="code" href="class_open_n_n_1_1_perceptron.html#6a963f1a06dfe2cc626402f118aec3b1">00140</a> <span class="keyword">const</span> <a class="code" href="class_open_n_n_1_1_perceptron.html#b22b1bcff267fe3b66afa485520ddea9" title="Enumeration of available activation functions for the perceptron neuron model.">Perceptron::ActivationFunction</a>&amp; <a class="code" href="class_open_n_n_1_1_perceptron.html#6a963f1a06dfe2cc626402f118aec3b1" title="This method returns the activation function of the neuron.">Perceptron::get_activation_function</a>(<span class="keywordtype">void</span>)<span class="keyword"> const </span>
<a name="l00141"></a>00141 <span class="keyword"></span>{
<a name="l00142"></a>00142    <span class="keywordflow">return</span>(activation_function);                           
<a name="l00143"></a>00143 }
<a name="l00144"></a>00144 
<a name="l00145"></a>00145 
<a name="l00146"></a>00146 <span class="comment">// std::string write_activation_function(void) const method</span>
<a name="l00147"></a>00147 
<a name="l00149"></a>00149 
<a name="l00150"></a><a class="code" href="class_open_n_n_1_1_perceptron.html#caa09313a43f0271a9ade7ec36a55a37">00150</a> std::string <a class="code" href="class_open_n_n_1_1_perceptron.html#caa09313a43f0271a9ade7ec36a55a37" title="This method returns a string with the name of the activation function of the neuron...">Perceptron::write_activation_function</a>(<span class="keywordtype">void</span>)<span class="keyword"> const</span>
<a name="l00151"></a>00151 <span class="keyword"></span>{
<a name="l00152"></a>00152    <span class="keywordflow">switch</span>(activation_function)
<a name="l00153"></a>00153    {
<a name="l00154"></a>00154       <span class="keywordflow">case</span> Perceptron::Logistic:   
<a name="l00155"></a>00155       {
<a name="l00156"></a>00156          <span class="keywordflow">return</span>(<span class="stringliteral">"Logistic"</span>);
<a name="l00157"></a>00157       }
<a name="l00158"></a>00158       <span class="keywordflow">break</span>;
<a name="l00159"></a>00159 
<a name="l00160"></a>00160       <span class="keywordflow">case</span> Perceptron::HyperbolicTangent:   
<a name="l00161"></a>00161       {
<a name="l00162"></a>00162          <span class="keywordflow">return</span>(<span class="stringliteral">"HyperbolicTangent"</span>);
<a name="l00163"></a>00163       }
<a name="l00164"></a>00164       <span class="keywordflow">break</span>;
<a name="l00165"></a>00165 
<a name="l00166"></a>00166       <span class="keywordflow">case</span> Perceptron::Threshold:   
<a name="l00167"></a>00167       {
<a name="l00168"></a>00168          <span class="keywordflow">return</span>(<span class="stringliteral">"Threshold"</span>);
<a name="l00169"></a>00169       }
<a name="l00170"></a>00170       <span class="keywordflow">break</span>;
<a name="l00171"></a>00171 
<a name="l00172"></a>00172       <span class="keywordflow">case</span> Perceptron::SymmetricThreshold:   
<a name="l00173"></a>00173       {
<a name="l00174"></a>00174          <span class="keywordflow">return</span>(<span class="stringliteral">"SymmetricThreshold"</span>);
<a name="l00175"></a>00175       }
<a name="l00176"></a>00176       <span class="keywordflow">break</span>;
<a name="l00177"></a>00177 
<a name="l00178"></a>00178       <span class="keywordflow">case</span> Perceptron::Linear:   
<a name="l00179"></a>00179       {
<a name="l00180"></a>00180          <span class="keywordflow">return</span>(<span class="stringliteral">"Linear"</span>);
<a name="l00181"></a>00181       }
<a name="l00182"></a>00182       <span class="keywordflow">break</span>;
<a name="l00183"></a>00183 
<a name="l00184"></a>00184       <span class="keywordflow">default</span>:
<a name="l00185"></a>00185       {
<a name="l00186"></a>00186          std::ostringstream buffer;
<a name="l00187"></a>00187 
<a name="l00188"></a>00188          buffer &lt;&lt; <span class="stringliteral">"OpenNN Exception: Perceptron class.\n"</span> 
<a name="l00189"></a>00189                 &lt;&lt; <span class="stringliteral">"std::string get_activation_function(void) const method.\n"</span>
<a name="l00190"></a>00190                 &lt;&lt; <span class="stringliteral">"Unknown activation function.\n"</span>;
<a name="l00191"></a>00191 
<a name="l00192"></a>00192          <span class="keywordflow">throw</span> std::logic_error(buffer.str());
<a name="l00193"></a>00193       }
<a name="l00194"></a>00194       <span class="keywordflow">break</span>;
<a name="l00195"></a>00195    }
<a name="l00196"></a>00196 }
<a name="l00197"></a>00197 
<a name="l00198"></a>00198 
<a name="l00199"></a>00199 <span class="comment">// unsigned int count_inputs_number(void) const method</span>
<a name="l00200"></a>00200 
<a name="l00202"></a>00202 
<a name="l00203"></a><a class="code" href="class_open_n_n_1_1_perceptron.html#b41fa60d5a3c6903a739327274784e40">00203</a> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="class_open_n_n_1_1_perceptron.html#b41fa60d5a3c6903a739327274784e40" title="This method returns the number of inputs to the neuron.">Perceptron::count_inputs_number</a>(<span class="keywordtype">void</span>)<span class="keyword"> const</span>
<a name="l00204"></a>00204 <span class="keyword"></span>{
<a name="l00205"></a>00205    <span class="keywordflow">return</span>(synaptic_weights.size());
<a name="l00206"></a>00206 }    
<a name="l00207"></a>00207 
<a name="l00208"></a>00208 
<a name="l00209"></a>00209 <span class="comment">// double get_bias(void) const method</span>
<a name="l00210"></a>00210 
<a name="l00212"></a>00212 
<a name="l00213"></a><a class="code" href="class_open_n_n_1_1_perceptron.html#0c3a8d82643153ccb7a9c8e6455cfc69">00213</a> <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; <a class="code" href="class_open_n_n_1_1_perceptron.html#0c3a8d82643153ccb7a9c8e6455cfc69" title="This method returns the bias value of the neuron.">Perceptron::get_bias</a>(<span class="keywordtype">void</span>)<span class="keyword"> const</span>
<a name="l00214"></a>00214 <span class="keyword"></span>{
<a name="l00215"></a>00215    <span class="keywordflow">return</span>(bias);
<a name="l00216"></a>00216 }
<a name="l00217"></a>00217 
<a name="l00218"></a>00218 
<a name="l00219"></a>00219 <span class="comment">// Vector&lt;double&gt;&amp; arrange_synaptic_weights(void)</span>
<a name="l00220"></a>00220 
<a name="l00222"></a>00222 
<a name="l00223"></a><a class="code" href="class_open_n_n_1_1_perceptron.html#a2ee520c41eb30f9a71c54b82ab20d91">00223</a> <span class="keyword">const</span> <a class="code" href="class_open_n_n_1_1_vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="class_open_n_n_1_1_perceptron.html#a2ee520c41eb30f9a71c54b82ab20d91" title="This method returns the synaptic weight values of the neuron.">Perceptron::arrange_synaptic_weights</a>(<span class="keywordtype">void</span>)<span class="keyword"> const</span>
<a name="l00224"></a>00224 <span class="keyword"></span>{
<a name="l00225"></a>00225    <span class="keywordflow">return</span>(synaptic_weights);
<a name="l00226"></a>00226 }
<a name="l00227"></a>00227 
<a name="l00228"></a>00228 
<a name="l00229"></a>00229 <span class="comment">// double get_synaptic_weight(const unsigned int&amp;) const method</span>
<a name="l00230"></a>00230 
<a name="l00233"></a>00233  
<a name="l00234"></a><a class="code" href="class_open_n_n_1_1_perceptron.html#afd98ee5912b042f5b65f0919117232f">00234</a> <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; <a class="code" href="class_open_n_n_1_1_perceptron.html#afd98ee5912b042f5b65f0919117232f">Perceptron::get_synaptic_weight</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&amp; synaptic_weight_index)<span class="keyword"> const</span>
<a name="l00235"></a>00235 <span class="keyword"></span>{
<a name="l00236"></a>00236    <span class="comment">// Control sentence (if debug)</span>
<a name="l00237"></a>00237 
<a name="l00238"></a>00238 <span class="preprocessor">   #ifdef _DEBUG </span>
<a name="l00239"></a>00239 <span class="preprocessor"></span>      
<a name="l00240"></a>00240    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> inputs_number = <a class="code" href="class_open_n_n_1_1_perceptron.html#b41fa60d5a3c6903a739327274784e40" title="This method returns the number of inputs to the neuron.">count_inputs_number</a>();
<a name="l00241"></a>00241 
<a name="l00242"></a>00242    <span class="keywordflow">if</span>(synaptic_weight_index &gt;= inputs_number)
<a name="l00243"></a>00243    {
<a name="l00244"></a>00244       std::ostringstream buffer;
<a name="l00245"></a>00245 
<a name="l00246"></a>00246           buffer &lt;&lt; <span class="stringliteral">"OpenNN Exception: Perceptron class.\n"</span>
<a name="l00247"></a>00247                 &lt;&lt; <span class="stringliteral">"double get_synaptic_weight(const unsigned int&amp;) const method.\n"</span>
<a name="l00248"></a>00248                 &lt;&lt; <span class="stringliteral">"Index of synaptic weight must be less than number of inputs.\n"</span>;
<a name="l00249"></a>00249 
<a name="l00250"></a>00250       <span class="keywordflow">throw</span> std::logic_error(buffer.str());
<a name="l00251"></a>00251    }
<a name="l00252"></a>00252 
<a name="l00253"></a>00253 <span class="preprocessor">   #endif</span>
<a name="l00254"></a>00254 <span class="preprocessor"></span>
<a name="l00255"></a>00255    <span class="comment">// Get single synaptic weights</span>
<a name="l00256"></a>00256 
<a name="l00257"></a>00257    <span class="keywordflow">return</span>(synaptic_weights[synaptic_weight_index]);   
<a name="l00258"></a>00258 }
<a name="l00259"></a>00259 
<a name="l00260"></a>00260 
<a name="l00261"></a>00261 <span class="comment">// const bool&amp; get_display(void) const method</span>
<a name="l00262"></a>00262 
<a name="l00265"></a>00265 
<a name="l00266"></a><a class="code" href="class_open_n_n_1_1_perceptron.html#e4c9e7eeb553bc239e30316829e44208">00266</a> <span class="keyword">const</span> <span class="keywordtype">bool</span>&amp; <a class="code" href="class_open_n_n_1_1_perceptron.html#e4c9e7eeb553bc239e30316829e44208">Perceptron::get_display</a>(<span class="keywordtype">void</span>)<span class="keyword"> const</span>
<a name="l00267"></a>00267 <span class="keyword"></span>{
<a name="l00268"></a>00268    <span class="keywordflow">return</span>(display);
<a name="l00269"></a>00269 }
<a name="l00270"></a>00270 
<a name="l00271"></a>00271 
<a name="l00272"></a>00272 <span class="comment">//  void set(void) method</span>
<a name="l00273"></a>00273 
<a name="l00275"></a>00275 
<a name="l00276"></a><a class="code" href="class_open_n_n_1_1_perceptron.html#76cf2bd05072ffcbe1fbc8241dc1656a">00276</a> <span class="keywordtype">void</span> <a class="code" href="class_open_n_n_1_1_perceptron.html#76cf2bd05072ffcbe1fbc8241dc1656a" title="This method sets the number of inputs to zero and the rest of members to their default...">Perceptron::set</a>(<span class="keywordtype">void</span>)
<a name="l00277"></a>00277 {
<a name="l00278"></a>00278    <a class="code" href="class_open_n_n_1_1_perceptron.html#48b1ba1e3e78e00e7113fe9af72179a1">initialize_bias_normal</a>(0.0, 0.2);
<a name="l00279"></a>00279 
<a name="l00280"></a>00280    synaptic_weights.<a class="code" href="class_open_n_n_1_1_vector.html#78a81ff993befcd4e75ab75da2976a9a" title="This method sets the size of a vector to zero.">set</a>();
<a name="l00281"></a>00281 
<a name="l00282"></a>00282    activation_function = HyperbolicTangent;
<a name="l00283"></a>00283 
<a name="l00284"></a>00284    display = <span class="keyword">true</span>;
<a name="l00285"></a>00285 }
<a name="l00286"></a>00286 
<a name="l00287"></a>00287 
<a name="l00288"></a>00288 <span class="comment">// void set(const unsigned int&amp;) method</span>
<a name="l00289"></a>00289 
<a name="l00293"></a>00293 
<a name="l00294"></a><a class="code" href="class_open_n_n_1_1_perceptron.html#78e1f2081f36201762449d7a68187216">00294</a> <span class="keywordtype">void</span> <a class="code" href="class_open_n_n_1_1_perceptron.html#76cf2bd05072ffcbe1fbc8241dc1656a" title="This method sets the number of inputs to zero and the rest of members to their default...">Perceptron::set</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&amp; new_inputs_number)
<a name="l00295"></a>00295 {
<a name="l00296"></a>00296    <span class="comment">// Set synaptic weights</span>
<a name="l00297"></a>00297 
<a name="l00298"></a>00298    activation_function = HyperbolicTangent;
<a name="l00299"></a>00299 
<a name="l00300"></a>00300    <a class="code" href="class_open_n_n_1_1_perceptron.html#48b1ba1e3e78e00e7113fe9af72179a1">initialize_bias_normal</a>(0.0, 0.2);
<a name="l00301"></a>00301 
<a name="l00302"></a>00302    synaptic_weights.<a class="code" href="class_open_n_n_1_1_vector.html#78a81ff993befcd4e75ab75da2976a9a" title="This method sets the size of a vector to zero.">set</a>(new_inputs_number);   
<a name="l00303"></a>00303    <a class="code" href="class_open_n_n_1_1_perceptron.html#a208d60d231f6f98b4f7c41b3bf421c6">initialize_synaptic_weights_normal</a>(0.0, 0.2);
<a name="l00304"></a>00304    
<a name="l00305"></a>00305    display = <span class="keyword">true</span>;
<a name="l00306"></a>00306 }
<a name="l00307"></a>00307 
<a name="l00308"></a>00308 
<a name="l00309"></a>00309 <span class="comment">// void set(const unsigned int&amp;, const double&amp;) method</span>
<a name="l00310"></a>00310 
<a name="l00314"></a>00314 
<a name="l00315"></a><a class="code" href="class_open_n_n_1_1_perceptron.html#13bf6a9d1e9cff74f011fa9a5c826257">00315</a> <span class="keywordtype">void</span> <a class="code" href="class_open_n_n_1_1_perceptron.html#76cf2bd05072ffcbe1fbc8241dc1656a" title="This method sets the number of inputs to zero and the rest of members to their default...">Perceptron::set</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&amp; new_inputs_number, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; new_parameters_value)
<a name="l00316"></a>00316 {
<a name="l00317"></a>00317    bias = new_parameters_value;
<a name="l00318"></a>00318    synaptic_weights.<a class="code" href="class_open_n_n_1_1_vector.html#78a81ff993befcd4e75ab75da2976a9a" title="This method sets the size of a vector to zero.">set</a>(new_inputs_number, new_parameters_value);
<a name="l00319"></a>00319 
<a name="l00320"></a>00320    activation_function = HyperbolicTangent;
<a name="l00321"></a>00321 
<a name="l00322"></a>00322    display = <span class="keyword">true</span>;
<a name="l00323"></a>00323 }
<a name="l00324"></a>00324 
<a name="l00325"></a>00325 
<a name="l00326"></a>00326 <span class="comment">// void set(const Perceptron&amp;)</span>
<a name="l00327"></a>00327 
<a name="l00330"></a>00330 
<a name="l00331"></a><a class="code" href="class_open_n_n_1_1_perceptron.html#f63a296063b7dafb2bde6f089542fcc4">00331</a> <span class="keywordtype">void</span> <a class="code" href="class_open_n_n_1_1_perceptron.html#76cf2bd05072ffcbe1fbc8241dc1656a" title="This method sets the number of inputs to zero and the rest of members to their default...">Perceptron::set</a>(<span class="keyword">const</span> <a class="code" href="class_open_n_n_1_1_perceptron.html">Perceptron</a>&amp; other_perceptron)
<a name="l00332"></a>00332 {
<a name="l00333"></a>00333    bias = other_perceptron.bias;
<a name="l00334"></a>00334    
<a name="l00335"></a>00335    synaptic_weights = other_perceptron.synaptic_weights;
<a name="l00336"></a>00336 
<a name="l00337"></a>00337    activation_function = other_perceptron.activation_function;
<a name="l00338"></a>00338 
<a name="l00339"></a>00339    display = other_perceptron.display;
<a name="l00340"></a>00340 }
<a name="l00341"></a>00341 
<a name="l00342"></a>00342 
<a name="l00343"></a>00343 <span class="comment">// void set_activation_function(const ActivationFunction&amp;) method</span>
<a name="l00344"></a>00344 
<a name="l00347"></a>00347 
<a name="l00348"></a><a class="code" href="class_open_n_n_1_1_perceptron.html#7992ebd310c652b7972f07a4ab679a71">00348</a> <span class="keywordtype">void</span> <a class="code" href="class_open_n_n_1_1_perceptron.html#7992ebd310c652b7972f07a4ab679a71">Perceptron::set_activation_function</a>(<span class="keyword">const</span> <a class="code" href="class_open_n_n_1_1_perceptron.html#b22b1bcff267fe3b66afa485520ddea9" title="Enumeration of available activation functions for the perceptron neuron model.">Perceptron::ActivationFunction</a>&amp; new_activation_function)
<a name="l00349"></a>00349 {
<a name="l00350"></a>00350    activation_function = new_activation_function;
<a name="l00351"></a>00351 }
<a name="l00352"></a>00352 
<a name="l00353"></a>00353 
<a name="l00354"></a>00354 <span class="comment">// void set_activation_function(const std::string&amp;) method</span>
<a name="l00355"></a>00355 
<a name="l00359"></a>00359 
<a name="l00360"></a><a class="code" href="class_open_n_n_1_1_perceptron.html#8d90becf34b0180258c68fc9e1b8053b">00360</a> <span class="keywordtype">void</span> <a class="code" href="class_open_n_n_1_1_perceptron.html#7992ebd310c652b7972f07a4ab679a71">Perceptron::set_activation_function</a>(<span class="keyword">const</span> std::string&amp; new_activation_function_name)
<a name="l00361"></a>00361 {
<a name="l00362"></a>00362    <span class="keywordflow">if</span>(new_activation_function_name == <span class="stringliteral">"Logistic"</span>)
<a name="l00363"></a>00363    {
<a name="l00364"></a>00364       activation_function = Logistic;
<a name="l00365"></a>00365    }
<a name="l00366"></a>00366    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(new_activation_function_name == <span class="stringliteral">"HyperbolicTangent"</span>)
<a name="l00367"></a>00367    {
<a name="l00368"></a>00368       activation_function = HyperbolicTangent;
<a name="l00369"></a>00369    }
<a name="l00370"></a>00370    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(new_activation_function_name == <span class="stringliteral">"Threshold"</span>)
<a name="l00371"></a>00371    {
<a name="l00372"></a>00372       activation_function = Threshold;
<a name="l00373"></a>00373    }
<a name="l00374"></a>00374    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(new_activation_function_name == <span class="stringliteral">"SymmetricThreshold"</span>)
<a name="l00375"></a>00375    {
<a name="l00376"></a>00376       activation_function = SymmetricThreshold;
<a name="l00377"></a>00377    }
<a name="l00378"></a>00378    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(new_activation_function_name == <span class="stringliteral">"Linear"</span>)
<a name="l00379"></a>00379    {
<a name="l00380"></a>00380       activation_function = Linear;
<a name="l00381"></a>00381    }
<a name="l00382"></a>00382    <span class="keywordflow">else</span>
<a name="l00383"></a>00383    {
<a name="l00384"></a>00384       std::ostringstream buffer;
<a name="l00385"></a>00385 
<a name="l00386"></a>00386       buffer &lt;&lt; <span class="stringliteral">"OpenNN Exception: Perceptron class.\n"</span>
<a name="l00387"></a>00387              &lt;&lt; <span class="stringliteral">"void set_activation_function(const std::string&amp;) method.\n"</span>
<a name="l00388"></a>00388                  &lt;&lt; <span class="stringliteral">"Unknown activation function: "</span> &lt;&lt; new_activation_function_name &lt;&lt; <span class="stringliteral">".\n"</span>;
<a name="l00389"></a>00389 
<a name="l00390"></a>00390       <span class="keywordflow">throw</span> std::logic_error(buffer.str());
<a name="l00391"></a>00391    }
<a name="l00392"></a>00392 }
<a name="l00393"></a>00393 
<a name="l00394"></a>00394 
<a name="l00395"></a>00395 <span class="comment">// void set_bias(const double&amp;) method</span>
<a name="l00396"></a>00396 
<a name="l00399"></a>00399  
<a name="l00400"></a><a class="code" href="class_open_n_n_1_1_perceptron.html#a828d7f79aa5635ec542b189020828b0">00400</a> <span class="keywordtype">void</span> <a class="code" href="class_open_n_n_1_1_perceptron.html#a828d7f79aa5635ec542b189020828b0">Perceptron::set_bias</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>&amp; new_bias)
<a name="l00401"></a>00401 {
<a name="l00402"></a>00402    bias = new_bias;   
<a name="l00403"></a>00403 }
<a name="l00404"></a>00404 
<a name="l00405"></a>00405 
<a name="l00406"></a>00406 <span class="comment">// void set_synaptic_weights(const Vector&lt;double&gt;&amp;) method</span>
<a name="l00407"></a>00407 
<a name="l00410"></a>00410  
<a name="l00411"></a><a class="code" href="class_open_n_n_1_1_perceptron.html#93c5dd99d7287600c118e6da7d5069fc">00411</a> <span class="keywordtype">void</span> <a class="code" href="class_open_n_n_1_1_perceptron.html#93c5dd99d7287600c118e6da7d5069fc">Perceptron::set_synaptic_weights</a>(<span class="keyword">const</span> <a class="code" href="class_open_n_n_1_1_vector.html">Vector&lt;double&gt;</a>&amp; new_synaptic_weights)
<a name="l00412"></a>00412 {
<a name="l00413"></a>00413    <span class="comment">// Control sentence (if debug)</span>
<a name="l00414"></a>00414 
<a name="l00415"></a>00415 <span class="preprocessor">   #ifdef _DEBUG </span>
<a name="l00416"></a>00416 <span class="preprocessor"></span>
<a name="l00417"></a>00417    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> inputs_number = <a class="code" href="class_open_n_n_1_1_perceptron.html#b41fa60d5a3c6903a739327274784e40" title="This method returns the number of inputs to the neuron.">count_inputs_number</a>();
<a name="l00418"></a>00418 
<a name="l00419"></a>00419    <span class="keywordflow">if</span>(new_synaptic_weights.size() != inputs_number)
<a name="l00420"></a>00420    {
<a name="l00421"></a>00421       std::ostringstream buffer;
<a name="l00422"></a>00422 
<a name="l00423"></a>00423       buffer &lt;&lt; <span class="stringliteral">"OpenNN Exception: Perceptron class.\n"</span>
<a name="l00424"></a>00424              &lt;&lt; <span class="stringliteral">"void set_synaptic_weights(const Vector&lt;double&gt;&amp;) method.\n"</span>
<a name="l00425"></a>00425              &lt;&lt; <span class="stringliteral">"Size of synaptic weights vector must be equal to number of inputs.\n"</span>;
<a name="l00426"></a>00426 
<a name="l00427"></a>00427       <span class="keywordflow">throw</span> std::logic_error(buffer.str());
<a name="l00428"></a>00428    }
<a name="l00429"></a>00429 
<a name="l00430"></a>00430 <span class="preprocessor">   #endif</span>
<a name="l00431"></a>00431 <span class="preprocessor"></span>
<a name="l00432"></a>00432    <span class="comment">// Set synaptic weights</span>
<a name="l00433"></a>00433    
<a name="l00434"></a>00434    synaptic_weights = new_synaptic_weights;
<a name="l00435"></a>00435 }
<a name="l00436"></a>00436 
<a name="l00437"></a>00437 
<a name="l00438"></a>00438 <span class="comment">// void set_synaptic_weight(const unsigned int&amp;, const double&amp;) method</span>
<a name="l00439"></a>00439 
<a name="l00443"></a>00443 
<a name="l00444"></a><a class="code" href="class_open_n_n_1_1_perceptron.html#cc587c70a55a1482e8a22c5e26974d1e">00444</a> <span class="keywordtype">void</span> <a class="code" href="class_open_n_n_1_1_perceptron.html#cc587c70a55a1482e8a22c5e26974d1e">Perceptron::set_synaptic_weight</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&amp; synaptic_weight_index, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; new_synaptic_weight)
<a name="l00445"></a>00445 {
<a name="l00446"></a>00446    <span class="comment">// Control sentence (if debug)</span>
<a name="l00447"></a>00447 
<a name="l00448"></a>00448 <span class="preprocessor">   #ifdef _DEBUG </span>
<a name="l00449"></a>00449 <span class="preprocessor"></span>
<a name="l00450"></a>00450    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> inputs_number = <a class="code" href="class_open_n_n_1_1_perceptron.html#b41fa60d5a3c6903a739327274784e40" title="This method returns the number of inputs to the neuron.">count_inputs_number</a>();
<a name="l00451"></a>00451 
<a name="l00452"></a>00452    <span class="keywordflow">if</span>(synaptic_weight_index &gt;= inputs_number)
<a name="l00453"></a>00453    {
<a name="l00454"></a>00454       std::ostringstream buffer;
<a name="l00455"></a>00455 
<a name="l00456"></a>00456       buffer &lt;&lt; <span class="stringliteral">"OpenNN Exception: Perceptron class.\n"</span>
<a name="l00457"></a>00457              &lt;&lt; <span class="stringliteral">"void set_synaptic_weight(const unsigned int&amp;, const double&amp;) method.\n"</span>
<a name="l00458"></a>00458              &lt;&lt; <span class="stringliteral">"Index of synaptic weight must be less than number of inputs.\n"</span>;
<a name="l00459"></a>00459 
<a name="l00460"></a>00460       <span class="keywordflow">throw</span> std::logic_error(buffer.str());
<a name="l00461"></a>00461    }
<a name="l00462"></a>00462 
<a name="l00463"></a>00463 <span class="preprocessor">   #endif</span>
<a name="l00464"></a>00464 <span class="preprocessor"></span>
<a name="l00465"></a>00465    <span class="comment">// Set single synaptic weight</span>
<a name="l00466"></a>00466 
<a name="l00467"></a>00467    synaptic_weights[synaptic_weight_index] = new_synaptic_weight;
<a name="l00468"></a>00468 }
<a name="l00469"></a>00469 
<a name="l00470"></a>00470 
<a name="l00471"></a>00471 <span class="comment">// void set_display(const bool&amp;) method</span>
<a name="l00472"></a>00472 
<a name="l00477"></a>00477  
<a name="l00478"></a><a class="code" href="class_open_n_n_1_1_perceptron.html#e963158bcbc33428e61663b2edacae3d">00478</a> <span class="keywordtype">void</span> <a class="code" href="class_open_n_n_1_1_perceptron.html#e963158bcbc33428e61663b2edacae3d">Perceptron::set_display</a>(<span class="keyword">const</span> <span class="keywordtype">bool</span>&amp; new_display)
<a name="l00479"></a>00479 {
<a name="l00480"></a>00480    display = new_display;   
<a name="l00481"></a>00481 }
<a name="l00482"></a>00482 
<a name="l00483"></a>00483 
<a name="l00484"></a>00484 <span class="comment">// void set_inputs_number(unsigned int) method</span>
<a name="l00485"></a>00485 
<a name="l00490"></a>00490  
<a name="l00491"></a><a class="code" href="class_open_n_n_1_1_perceptron.html#a680048b613a98394cc391ff25df58b7">00491</a> <span class="keywordtype">void</span> <a class="code" href="class_open_n_n_1_1_perceptron.html#a680048b613a98394cc391ff25df58b7">Perceptron::set_inputs_number</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&amp; new_inputs_number)
<a name="l00492"></a>00492 {
<a name="l00493"></a>00493    <a class="code" href="class_open_n_n_1_1_perceptron.html#48b1ba1e3e78e00e7113fe9af72179a1">initialize_bias_normal</a>(0.0,1.0);
<a name="l00494"></a>00494 
<a name="l00495"></a>00495    synaptic_weights.<a class="code" href="class_open_n_n_1_1_vector.html#78a81ff993befcd4e75ab75da2976a9a" title="This method sets the size of a vector to zero.">set</a>(new_inputs_number);
<a name="l00496"></a>00496    <a class="code" href="class_open_n_n_1_1_perceptron.html#a208d60d231f6f98b4f7c41b3bf421c6">initialize_synaptic_weights_normal</a>(0.0,1.0);
<a name="l00497"></a>00497 }
<a name="l00498"></a>00498 
<a name="l00499"></a>00499 
<a name="l00500"></a>00500 <span class="comment">// unsigned int count_parameters_number(void) const method</span>
<a name="l00501"></a>00501 
<a name="l00503"></a>00503 
<a name="l00504"></a><a class="code" href="class_open_n_n_1_1_perceptron.html#3d925e84360eef122af3b158e5884f15">00504</a> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="class_open_n_n_1_1_perceptron.html#3d925e84360eef122af3b158e5884f15" title="This method returns the number of parameters (bias and synaptic weights) in the perceptron...">Perceptron::count_parameters_number</a>(<span class="keywordtype">void</span>)<span class="keyword"> const</span>
<a name="l00505"></a>00505 <span class="keyword"></span>{
<a name="l00506"></a>00506    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> inputs_number = <a class="code" href="class_open_n_n_1_1_perceptron.html#b41fa60d5a3c6903a739327274784e40" title="This method returns the number of inputs to the neuron.">count_inputs_number</a>();
<a name="l00507"></a>00507    
<a name="l00508"></a>00508    <span class="keywordflow">return</span>(1 + inputs_number);
<a name="l00509"></a>00509 }
<a name="l00510"></a>00510 
<a name="l00511"></a>00511 
<a name="l00512"></a>00512 <span class="comment">// Vector&lt;double&gt; arrange_parameters(void) const method</span>
<a name="l00513"></a>00513 
<a name="l00515"></a>00515 
<a name="l00516"></a><a class="code" href="class_open_n_n_1_1_perceptron.html#bb75ff0fc1bff3fbd5a6815675a7c0f5">00516</a> <a class="code" href="class_open_n_n_1_1_vector.html">Vector&lt;double&gt;</a> <a class="code" href="class_open_n_n_1_1_perceptron.html#bb75ff0fc1bff3fbd5a6815675a7c0f5" title="This method returns the parameters (bias and synaptic weights) of the perceptron...">Perceptron::arrange_parameters</a>(<span class="keywordtype">void</span>)<span class="keyword"> const</span>
<a name="l00517"></a>00517 <span class="keyword"></span>{
<a name="l00518"></a>00518    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> parameters_number = <a class="code" href="class_open_n_n_1_1_perceptron.html#3d925e84360eef122af3b158e5884f15" title="This method returns the number of parameters (bias and synaptic weights) in the perceptron...">count_parameters_number</a>();
<a name="l00519"></a>00519 
<a name="l00520"></a>00520    <a class="code" href="class_open_n_n_1_1_vector.html">Vector&lt;double&gt;</a> parameters(parameters_number);
<a name="l00521"></a>00521 
<a name="l00522"></a>00522    parameters[0] = bias;
<a name="l00523"></a>00523 
<a name="l00524"></a>00524    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> inputs_number = <a class="code" href="class_open_n_n_1_1_perceptron.html#b41fa60d5a3c6903a739327274784e40" title="This method returns the number of inputs to the neuron.">count_inputs_number</a>();
<a name="l00525"></a>00525 
<a name="l00526"></a>00526    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; inputs_number; i++)
<a name="l00527"></a>00527    {
<a name="l00528"></a>00528       parameters[(<span class="keywordtype">unsigned</span> int)1+i] = synaptic_weights[i];
<a name="l00529"></a>00529    }
<a name="l00530"></a>00530 
<a name="l00531"></a>00531    <span class="keywordflow">return</span>(parameters); 
<a name="l00532"></a>00532 }
<a name="l00533"></a>00533 
<a name="l00534"></a>00534 
<a name="l00535"></a>00535 <span class="comment">// void set_parameters(const Vector&lt;double&gt;&amp;) method</span>
<a name="l00536"></a>00536 
<a name="l00539"></a>00539 
<a name="l00540"></a><a class="code" href="class_open_n_n_1_1_perceptron.html#faf7f1580706aa95289f2c6a762bb189">00540</a> <span class="keywordtype">void</span> <a class="code" href="class_open_n_n_1_1_perceptron.html#faf7f1580706aa95289f2c6a762bb189">Perceptron::set_parameters</a>(<span class="keyword">const</span> <a class="code" href="class_open_n_n_1_1_vector.html">Vector&lt;double&gt;</a>&amp; new_parameters)
<a name="l00541"></a>00541 {
<a name="l00542"></a>00542    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> inputs_number = <a class="code" href="class_open_n_n_1_1_perceptron.html#b41fa60d5a3c6903a739327274784e40" title="This method returns the number of inputs to the neuron.">count_inputs_number</a>();
<a name="l00543"></a>00543 
<a name="l00544"></a>00544    <span class="comment">// Control sentence (if debug)</span>
<a name="l00545"></a>00545 
<a name="l00546"></a>00546 <span class="preprocessor">   #ifdef _DEBUG </span>
<a name="l00547"></a>00547 <span class="preprocessor"></span>
<a name="l00548"></a>00548    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> size = new_parameters.size();
<a name="l00549"></a>00549 
<a name="l00550"></a>00550    <span class="keywordflow">if</span>(size != 1+inputs_number)
<a name="l00551"></a>00551    {
<a name="l00552"></a>00552           std::ostringstream buffer;
<a name="l00553"></a>00553 
<a name="l00554"></a>00554       buffer &lt;&lt; <span class="stringliteral">"OpenNN Exception: Perceptron class.\n"</span>
<a name="l00555"></a>00555              &lt;&lt; <span class="stringliteral">"void set_parameters(const Vector&lt;double&gt;&amp;) method.\n"</span>
<a name="l00556"></a>00556              &lt;&lt; <span class="stringliteral">"Size must be equal to one plus number of inputs.\n"</span>;
<a name="l00557"></a>00557 
<a name="l00558"></a>00558       <span class="keywordflow">throw</span> std::logic_error(buffer.str());
<a name="l00559"></a>00559    }
<a name="l00560"></a>00560 
<a name="l00561"></a>00561 <span class="preprocessor">   #endif</span>
<a name="l00562"></a>00562 <span class="preprocessor"></span>
<a name="l00563"></a>00563    bias = new_parameters[0];
<a name="l00564"></a>00564 
<a name="l00565"></a>00565    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; inputs_number; i++)
<a name="l00566"></a>00566    {
<a name="l00567"></a>00567       synaptic_weights[i] = new_parameters[i+1];
<a name="l00568"></a>00568    }
<a name="l00569"></a>00569 }
<a name="l00570"></a>00570 
<a name="l00571"></a>00571 
<a name="l00572"></a>00572 <span class="comment">// void initialize_bias(const double&amp;) method</span>
<a name="l00573"></a>00573 
<a name="l00576"></a>00576 
<a name="l00577"></a><a class="code" href="class_open_n_n_1_1_perceptron.html#fdc00c42cb1b46ab365fb74dd7ad2225">00577</a> <span class="keywordtype">void</span> <a class="code" href="class_open_n_n_1_1_perceptron.html#fdc00c42cb1b46ab365fb74dd7ad2225">Perceptron::initialize_bias</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>&amp; value)
<a name="l00578"></a>00578 {
<a name="l00579"></a>00579    bias = value;
<a name="l00580"></a>00580 }
<a name="l00581"></a>00581 
<a name="l00582"></a>00582 
<a name="l00583"></a>00583 <span class="comment">// void initialize_bias_uniform(const double&amp;, const double&amp;) method</span>
<a name="l00584"></a>00584 
<a name="l00588"></a>00588 
<a name="l00589"></a><a class="code" href="class_open_n_n_1_1_perceptron.html#61dfec368e301d0060b73bf41502a722">00589</a> <span class="keywordtype">void</span> <a class="code" href="class_open_n_n_1_1_perceptron.html#61dfec368e301d0060b73bf41502a722">Perceptron::initialize_bias_uniform</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>&amp; minimum, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; maximum)
<a name="l00590"></a>00590 {
<a name="l00591"></a>00591    <span class="comment">// Control sentence (if debug)</span>
<a name="l00592"></a>00592 
<a name="l00593"></a>00593 <span class="preprocessor">   #ifdef _DEBUG </span>
<a name="l00594"></a>00594 <span class="preprocessor"></span>
<a name="l00595"></a>00595    <span class="keywordflow">if</span>(minimum &gt; maximum)
<a name="l00596"></a>00596    {
<a name="l00597"></a>00597          std::ostringstream buffer;
<a name="l00598"></a>00598 
<a name="l00599"></a>00599       buffer &lt;&lt; <span class="stringliteral">"OpenNN Exception: Perceptron class.\n"</span> 
<a name="l00600"></a>00600              &lt;&lt; <span class="stringliteral">"initialize_bias_uniform(const double&amp;, const double&amp;) method.\n"</span>
<a name="l00601"></a>00601              &lt;&lt; <span class="stringliteral">"Minimum value must be less than maximum value.\n"</span>;
<a name="l00602"></a>00602 
<a name="l00603"></a>00603       <span class="keywordflow">throw</span> std::logic_error(buffer.str());
<a name="l00604"></a>00604    }
<a name="l00605"></a>00605 
<a name="l00606"></a>00606 <span class="preprocessor">   #endif</span>
<a name="l00607"></a>00607 <span class="preprocessor"></span>
<a name="l00608"></a>00608    bias = calculate_random_uniform(minimum, maximum);
<a name="l00609"></a>00609 }
<a name="l00610"></a>00610 
<a name="l00611"></a>00611 
<a name="l00612"></a>00612 <span class="comment">// void initialize_synaptic_weights(const double&amp;) method</span>
<a name="l00613"></a>00613 
<a name="l00616"></a>00616 
<a name="l00617"></a><a class="code" href="class_open_n_n_1_1_perceptron.html#9daa23b5ddc9a2770da2a0dcf3e31e09">00617</a> <span class="keywordtype">void</span> <a class="code" href="class_open_n_n_1_1_perceptron.html#9daa23b5ddc9a2770da2a0dcf3e31e09">Perceptron::initialize_synaptic_weights</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>&amp; value)
<a name="l00618"></a>00618 {
<a name="l00619"></a>00619    synaptic_weights.<a class="code" href="class_open_n_n_1_1_vector.html#283d758a3ec6c2e116620b173cc14f7c">initialize</a>(value);
<a name="l00620"></a>00620 }
<a name="l00621"></a>00621 
<a name="l00622"></a>00622 
<a name="l00623"></a>00623 <span class="comment">// void initialize_synaptic_weights_uniform(const double&amp;, const double&amp;) method</span>
<a name="l00624"></a>00624 
<a name="l00628"></a>00628 
<a name="l00629"></a><a class="code" href="class_open_n_n_1_1_perceptron.html#3ae54c83fcf3eb216f476d796b0d9961">00629</a> <span class="keywordtype">void</span> <a class="code" href="class_open_n_n_1_1_perceptron.html#3ae54c83fcf3eb216f476d796b0d9961">Perceptron::initialize_synaptic_weights_uniform</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>&amp; minimum, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; maximum)
<a name="l00630"></a>00630 {
<a name="l00631"></a>00631    synaptic_weights.<a class="code" href="class_open_n_n_1_1_vector.html#ad3935a890aa294f7cef557a33c57db3" title="This method assigns a random value comprised between -1 and 1 to each element in...">initialize_uniform</a>(minimum, maximum);
<a name="l00632"></a>00632 }
<a name="l00633"></a>00633 
<a name="l00634"></a>00634 
<a name="l00635"></a>00635 <span class="comment">// void initialize_bias_normal(const double&amp;, const double&amp;) method</span>
<a name="l00636"></a>00636 
<a name="l00640"></a>00640 
<a name="l00641"></a><a class="code" href="class_open_n_n_1_1_perceptron.html#48b1ba1e3e78e00e7113fe9af72179a1">00641</a> <span class="keywordtype">void</span> <a class="code" href="class_open_n_n_1_1_perceptron.html#48b1ba1e3e78e00e7113fe9af72179a1">Perceptron::initialize_bias_normal</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>&amp; mean, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; standard_deviation)
<a name="l00642"></a>00642 {
<a name="l00643"></a>00643    <span class="comment">// Control sentence (if debug)</span>
<a name="l00644"></a>00644 
<a name="l00645"></a>00645 <span class="preprocessor">   #ifdef _DEBUG </span>
<a name="l00646"></a>00646 <span class="preprocessor"></span>
<a name="l00647"></a>00647    <span class="keywordflow">if</span>(standard_deviation &lt; 0.0)
<a name="l00648"></a>00648    {
<a name="l00649"></a>00649       std::ostringstream buffer;
<a name="l00650"></a>00650 
<a name="l00651"></a>00651       buffer &lt;&lt; <span class="stringliteral">"OpenNN Exception: Perceptron class.\n"</span> 
<a name="l00652"></a>00652              &lt;&lt; <span class="stringliteral">"initialize_bias_normal(const double&amp;, const double&amp;) method.\n"</span>
<a name="l00653"></a>00653              &lt;&lt; <span class="stringliteral">"Standard deviation must be equal or greater than zero.\n"</span>;
<a name="l00654"></a>00654 
<a name="l00655"></a>00655       <span class="keywordflow">throw</span> std::logic_error(buffer.str());
<a name="l00656"></a>00656    }
<a name="l00657"></a>00657 
<a name="l00658"></a>00658 <span class="preprocessor">   #endif</span>
<a name="l00659"></a>00659 <span class="preprocessor"></span>
<a name="l00660"></a>00660    bias = calculate_random_normal(mean, standard_deviation);
<a name="l00661"></a>00661 }
<a name="l00662"></a>00662 
<a name="l00663"></a>00663 
<a name="l00664"></a>00664 <span class="comment">// void initialize_synaptic_weights_normal(const double&amp;, const double&amp;) method</span>
<a name="l00665"></a>00665 
<a name="l00669"></a>00669 
<a name="l00670"></a><a class="code" href="class_open_n_n_1_1_perceptron.html#a208d60d231f6f98b4f7c41b3bf421c6">00670</a> <span class="keywordtype">void</span> <a class="code" href="class_open_n_n_1_1_perceptron.html#a208d60d231f6f98b4f7c41b3bf421c6">Perceptron::initialize_synaptic_weights_normal</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>&amp; mean, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; standard_deviation)
<a name="l00671"></a>00671 {
<a name="l00672"></a>00672    synaptic_weights.<a class="code" href="class_open_n_n_1_1_vector.html#47595886933f54a6057fa27cc8523881">initialize_normal</a>(mean, standard_deviation);
<a name="l00673"></a>00673 }
<a name="l00674"></a>00674 
<a name="l00675"></a>00675 
<a name="l00676"></a>00676 <span class="comment">// void initialize_parameters(const double&amp;) method</span>
<a name="l00677"></a>00677 
<a name="l00680"></a>00680 
<a name="l00681"></a><a class="code" href="class_open_n_n_1_1_perceptron.html#1d75a07ccff9948f5d807e810da4e610">00681</a> <span class="keywordtype">void</span> <a class="code" href="class_open_n_n_1_1_perceptron.html#1d75a07ccff9948f5d807e810da4e610">Perceptron::initialize_parameters</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>&amp; value)
<a name="l00682"></a>00682 {
<a name="l00683"></a>00683    bias = value;
<a name="l00684"></a>00684    synaptic_weights.<a class="code" href="class_open_n_n_1_1_vector.html#283d758a3ec6c2e116620b173cc14f7c">initialize</a>(value);
<a name="l00685"></a>00685 }
<a name="l00686"></a>00686 
<a name="l00687"></a>00687 
<a name="l00688"></a>00688 <span class="comment">// double calculate_combination(const Vector&lt;double&gt;&amp;) method</span>
<a name="l00689"></a>00689 
<a name="l00693"></a>00693 
<a name="l00694"></a><a class="code" href="class_open_n_n_1_1_perceptron.html#c7fa457cc869606ac1d36c6edfaef3e7">00694</a> <span class="keywordtype">double</span> <a class="code" href="class_open_n_n_1_1_perceptron.html#c7fa457cc869606ac1d36c6edfaef3e7">Perceptron::calculate_combination</a>(<span class="keyword">const</span> <a class="code" href="class_open_n_n_1_1_vector.html">Vector&lt;double&gt;</a>&amp; inputs)<span class="keyword"> const</span>
<a name="l00695"></a>00695 <span class="keyword"></span>{
<a name="l00696"></a>00696    <span class="comment">// Control sentence (if debug)</span>
<a name="l00697"></a>00697 
<a name="l00698"></a>00698 <span class="preprocessor">   #ifdef _DEBUG </span>
<a name="l00699"></a>00699 <span class="preprocessor"></span>
<a name="l00700"></a>00700    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> inputs_number = <a class="code" href="class_open_n_n_1_1_perceptron.html#b41fa60d5a3c6903a739327274784e40" title="This method returns the number of inputs to the neuron.">count_inputs_number</a>();
<a name="l00701"></a>00701 
<a name="l00702"></a>00702    <span class="keywordflow">if</span>(inputs_number == 0)
<a name="l00703"></a>00703    {
<a name="l00704"></a>00704       std::ostringstream buffer;
<a name="l00705"></a>00705 
<a name="l00706"></a>00706       buffer &lt;&lt; <span class="stringliteral">"OpenNN Exception: Perceptron class.\n"</span> 
<a name="l00707"></a>00707              &lt;&lt; <span class="stringliteral">"calculate_combination(const Vector&lt;double&gt;&amp;) method.\n"</span>
<a name="l00708"></a>00708              &lt;&lt; <span class="stringliteral">"Number of inputs must be greater than zero.\n"</span>;
<a name="l00709"></a>00709 
<a name="l00710"></a>00710       <span class="keywordflow">throw</span> std::logic_error(buffer.str());
<a name="l00711"></a>00711    }
<a name="l00712"></a>00712 
<a name="l00713"></a>00713    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> inputs_size = inputs.size();
<a name="l00714"></a>00714 
<a name="l00715"></a>00715    <span class="keywordflow">if</span>(inputs_size != inputs_number)
<a name="l00716"></a>00716    {
<a name="l00717"></a>00717       std::ostringstream buffer;
<a name="l00718"></a>00718 
<a name="l00719"></a>00719       buffer &lt;&lt; <span class="stringliteral">"OpenNN Exception: Perceptron class.\n"</span>
<a name="l00720"></a>00720              &lt;&lt; <span class="stringliteral">"double calculate_combination(const Vector&lt;double&gt;&amp;) method.\n"</span>
<a name="l00721"></a>00721              &lt;&lt; <span class="stringliteral">"Size of inputs ("</span> &lt;&lt; inputs_size &lt;&lt; <span class="stringliteral">") must be equal to number of inputs ("</span> &lt;&lt; inputs_number &lt;&lt; <span class="stringliteral">").\n"</span>;
<a name="l00722"></a>00722 
<a name="l00723"></a>00723       <span class="keywordflow">throw</span> std::logic_error(buffer.str());
<a name="l00724"></a>00724    }
<a name="l00725"></a>00725 
<a name="l00726"></a>00726 <span class="preprocessor">   #endif</span>
<a name="l00727"></a>00727 <span class="preprocessor"></span>
<a name="l00728"></a>00728    <span class="comment">// Calculate combination</span>
<a name="l00729"></a>00729         
<a name="l00730"></a>00730    <span class="keywordflow">return</span>(bias + synaptic_weights.<a class="code" href="class_open_n_n_1_1_vector.html#0af2b14634f3dc1cea8ce692f77eb94e">dot</a>(inputs));   
<a name="l00731"></a>00731 }
<a name="l00732"></a>00732 
<a name="l00733"></a>00733 
<a name="l00734"></a>00734 <span class="comment">// double calculate_combination_parameters(const Vector&lt;double&gt;&amp;, const Vector&lt;double&gt;&amp;) const method</span>
<a name="l00735"></a>00735 
<a name="l00739"></a>00739 
<a name="l00740"></a><a class="code" href="class_open_n_n_1_1_perceptron.html#154f8f6738f09497c510896eefe75549">00740</a> <span class="keywordtype">double</span> <a class="code" href="class_open_n_n_1_1_perceptron.html#154f8f6738f09497c510896eefe75549">Perceptron::calculate_combination_parameters</a>(<span class="keyword">const</span> <a class="code" href="class_open_n_n_1_1_vector.html">Vector&lt;double&gt;</a>&amp; inputs, <span class="keyword">const</span> <a class="code" href="class_open_n_n_1_1_vector.html">Vector&lt;double&gt;</a>&amp; parameters)<span class="keyword"> const</span>
<a name="l00741"></a>00741 <span class="keyword"></span>{
<a name="l00742"></a>00742    <span class="comment">// Control sentence (if debug)</span>
<a name="l00743"></a>00743 
<a name="l00744"></a>00744 <span class="preprocessor">   #ifdef _DEBUG </span>
<a name="l00745"></a>00745 <span class="preprocessor"></span>
<a name="l00746"></a>00746    std::ostringstream buffer;
<a name="l00747"></a>00747 
<a name="l00748"></a>00748    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> inputs_size = inputs.size();
<a name="l00749"></a>00749    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> inputs_number = <a class="code" href="class_open_n_n_1_1_perceptron.html#b41fa60d5a3c6903a739327274784e40" title="This method returns the number of inputs to the neuron.">count_inputs_number</a>();
<a name="l00750"></a>00750 
<a name="l00751"></a>00751    <span class="keywordflow">if</span>(inputs_size != inputs_number)
<a name="l00752"></a>00752    {
<a name="l00753"></a>00753       buffer &lt;&lt; <span class="stringliteral">"OpenNN Exception: Perceptron class.\n"</span> 
<a name="l00754"></a>00754              &lt;&lt; <span class="stringliteral">"double calculate_combination_parameters(const Vector&lt;double&gt;&amp;, const Vector&lt;double&gt;&amp;) const method.\n"</span>
<a name="l00755"></a>00755              &lt;&lt; <span class="stringliteral">"Size of inputs must be equal to number of inputs.\n"</span>;
<a name="l00756"></a>00756 
<a name="l00757"></a>00757       <span class="keywordflow">throw</span> std::logic_error(buffer.str());
<a name="l00758"></a>00758    }
<a name="l00759"></a>00759 
<a name="l00760"></a>00760    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> parameters_size = parameters.size();
<a name="l00761"></a>00761 
<a name="l00762"></a>00762    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> parameters_number = <a class="code" href="class_open_n_n_1_1_perceptron.html#3d925e84360eef122af3b158e5884f15" title="This method returns the number of parameters (bias and synaptic weights) in the perceptron...">count_parameters_number</a>();
<a name="l00763"></a>00763 
<a name="l00764"></a>00764    <span class="keywordflow">if</span>(parameters_size != parameters_number)
<a name="l00765"></a>00765    {
<a name="l00766"></a>00766       buffer &lt;&lt; <span class="stringliteral">"OpenNN Exception: Perceptron class.\n"</span> 
<a name="l00767"></a>00767              &lt;&lt; <span class="stringliteral">"double calculate_combination_parameters(const Vector&lt;double&gt;&amp;, const Vector&lt;double&gt;&amp;) const method.\n"</span>
<a name="l00768"></a>00768              &lt;&lt; <span class="stringliteral">"Size of potential parameters ("</span> &lt;&lt; parameters_size &lt;&lt; <span class="stringliteral">") must be equal to number of parameters ("</span> &lt;&lt; parameters_number &lt;&lt; <span class="stringliteral">").\n"</span>;
<a name="l00769"></a>00769 
<a name="l00770"></a>00770       <span class="keywordflow">throw</span> std::logic_error(buffer.str());
<a name="l00771"></a>00771    }
<a name="l00772"></a>00772 
<a name="l00773"></a>00773 <span class="preprocessor">   #endif</span>
<a name="l00774"></a>00774 <span class="preprocessor"></span>
<a name="l00775"></a>00775    <span class="comment">// Construct a copy </span>
<a name="l00776"></a>00776 
<a name="l00777"></a>00777    <a class="code" href="class_open_n_n_1_1_perceptron.html">Perceptron</a> copy(*<span class="keyword">this</span>);
<a name="l00778"></a>00778 
<a name="l00779"></a>00779    <span class="comment">// Set potential parameters</span>
<a name="l00780"></a>00780 
<a name="l00781"></a>00781    copy.<a class="code" href="class_open_n_n_1_1_perceptron.html#faf7f1580706aa95289f2c6a762bb189">set_parameters</a>(parameters);
<a name="l00782"></a>00782 
<a name="l00783"></a>00783    <span class="comment">// Calculate combination</span>
<a name="l00784"></a>00784 
<a name="l00785"></a>00785    <span class="keywordflow">return</span>(copy.<a class="code" href="class_open_n_n_1_1_perceptron.html#c7fa457cc869606ac1d36c6edfaef3e7">calculate_combination</a>(inputs));  
<a name="l00786"></a>00786 }
<a name="l00787"></a>00787 
<a name="l00788"></a>00788 
<a name="l00789"></a>00789 <span class="comment">// double calculate_activation(const double&amp;) const  method</span>
<a name="l00790"></a>00790 
<a name="l00794"></a>00794 
<a name="l00795"></a><a class="code" href="class_open_n_n_1_1_perceptron.html#a50c102b421082a2a59c3b0678a62993">00795</a> <span class="keywordtype">double</span> <a class="code" href="class_open_n_n_1_1_perceptron.html#a50c102b421082a2a59c3b0678a62993">Perceptron::calculate_activation</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>&amp; combination)<span class="keyword"> const</span>
<a name="l00796"></a>00796 <span class="keyword"></span>{
<a name="l00797"></a>00797    <span class="keywordflow">switch</span>(activation_function)   
<a name="l00798"></a>00798    {
<a name="l00799"></a>00799       <span class="keywordflow">case</span> Perceptron::Logistic:
<a name="l00800"></a>00800       {
<a name="l00801"></a>00801          <span class="keywordflow">return</span>(1.0/(1.0 + exp(-combination)));
<a name="l00802"></a>00802       }
<a name="l00803"></a>00803       <span class="keywordflow">break</span>;
<a name="l00804"></a>00804                                      
<a name="l00805"></a>00805       <span class="keywordflow">case</span> Perceptron::HyperbolicTangent:
<a name="l00806"></a>00806       {
<a name="l00807"></a>00807          <span class="keywordflow">return</span>(1.0-2.0/(exp(2.0*combination)+1.0));   
<a name="l00808"></a>00808       }
<a name="l00809"></a>00809       <span class="keywordflow">break</span>;
<a name="l00810"></a>00810 
<a name="l00811"></a>00811       <span class="keywordflow">case</span> Perceptron::Threshold:
<a name="l00812"></a>00812       {
<a name="l00813"></a>00813          <span class="keywordflow">if</span>(combination &lt; 0)
<a name="l00814"></a>00814          {
<a name="l00815"></a>00815             <span class="keywordflow">return</span>(0.0);
<a name="l00816"></a>00816          }
<a name="l00817"></a>00817          <span class="keywordflow">else</span>
<a name="l00818"></a>00818          {
<a name="l00819"></a>00819             <span class="keywordflow">return</span>(1.0);
<a name="l00820"></a>00820          }
<a name="l00821"></a>00821       }
<a name="l00822"></a>00822       <span class="keywordflow">break</span>;
<a name="l00823"></a>00823 
<a name="l00824"></a>00824       <span class="keywordflow">case</span> Perceptron::SymmetricThreshold:
<a name="l00825"></a>00825       {
<a name="l00826"></a>00826          <span class="keywordflow">if</span>(combination &lt; 0)
<a name="l00827"></a>00827          {
<a name="l00828"></a>00828             <span class="keywordflow">return</span>(-1.0);
<a name="l00829"></a>00829          }
<a name="l00830"></a>00830          <span class="keywordflow">else</span>
<a name="l00831"></a>00831          {
<a name="l00832"></a>00832             <span class="keywordflow">return</span>(1.0);
<a name="l00833"></a>00833          }
<a name="l00834"></a>00834       }
<a name="l00835"></a>00835       <span class="keywordflow">break</span>;
<a name="l00836"></a>00836 
<a name="l00837"></a>00837       <span class="keywordflow">case</span> Perceptron::Linear:
<a name="l00838"></a>00838       {
<a name="l00839"></a>00839          <span class="keywordflow">return</span>(combination);        
<a name="l00840"></a>00840       }
<a name="l00841"></a>00841       <span class="keywordflow">break</span>;
<a name="l00842"></a>00842       
<a name="l00843"></a>00843       <span class="keywordflow">default</span>:
<a name="l00844"></a>00844       {
<a name="l00845"></a>00845          std::ostringstream buffer;
<a name="l00846"></a>00846 
<a name="l00847"></a>00847          buffer &lt;&lt; <span class="stringliteral">"OpenNN Exception: Perceptron class.\n"</span> 
<a name="l00848"></a>00848                 &lt;&lt; <span class="stringliteral">"double calculate_activation(const double&amp;) const  method.\n"</span>
<a name="l00849"></a>00849                 &lt;&lt; <span class="stringliteral">"Unknown activation function.\n"</span>;
<a name="l00850"></a>00850 
<a name="l00851"></a>00851          <span class="keywordflow">throw</span> std::logic_error(buffer.str());
<a name="l00852"></a>00852       }
<a name="l00853"></a>00853       <span class="keywordflow">break</span>;
<a name="l00854"></a>00854    }
<a name="l00855"></a>00855 }
<a name="l00856"></a>00856 
<a name="l00857"></a>00857 
<a name="l00858"></a>00858 <span class="comment">// double calculate_activation_derivative(const double&amp;) const  method</span>
<a name="l00859"></a>00859 
<a name="l00863"></a>00863 
<a name="l00864"></a><a class="code" href="class_open_n_n_1_1_perceptron.html#7f75c848df5783623ea50d7da6abd894">00864</a> <span class="keywordtype">double</span> <a class="code" href="class_open_n_n_1_1_perceptron.html#7f75c848df5783623ea50d7da6abd894">Perceptron::calculate_activation_derivative</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>&amp; combination)<span class="keyword"> const</span>
<a name="l00865"></a>00865 <span class="keyword"></span>{
<a name="l00866"></a>00866    <span class="keywordflow">switch</span>(activation_function)   
<a name="l00867"></a>00867    {
<a name="l00868"></a>00868       <span class="keywordflow">case</span> Perceptron::Logistic:
<a name="l00869"></a>00869       {
<a name="l00870"></a>00870          <span class="keyword">const</span> <span class="keywordtype">double</span> exponent = exp(-combination);
<a name="l00871"></a>00871 
<a name="l00872"></a>00872          <span class="keywordflow">return</span>(exponent/((1.0+exponent)*(1.0+exponent)));
<a name="l00873"></a>00873       }
<a name="l00874"></a>00874       <span class="keywordflow">break</span>;
<a name="l00875"></a>00875                                      
<a name="l00876"></a>00876       <span class="keywordflow">case</span> Perceptron::HyperbolicTangent:
<a name="l00877"></a>00877       {
<a name="l00878"></a>00878          <span class="keywordflow">return</span>(1.0 - pow(tanh(combination), 2));
<a name="l00879"></a>00879       }
<a name="l00880"></a>00880       <span class="keywordflow">break</span>;
<a name="l00881"></a>00881 
<a name="l00882"></a>00882       <span class="keywordflow">case</span> Perceptron::Threshold:
<a name="l00883"></a>00883       {
<a name="l00884"></a>00884          <span class="keywordflow">if</span>(combination != 0.0)
<a name="l00885"></a>00885          {
<a name="l00886"></a>00886             <span class="keywordflow">return</span>(0.0); 
<a name="l00887"></a>00887          }
<a name="l00888"></a>00888          <span class="keywordflow">else</span>
<a name="l00889"></a>00889          {
<a name="l00890"></a>00890             std::ostringstream buffer;
<a name="l00891"></a>00891 
<a name="l00892"></a>00892             buffer &lt;&lt; <span class="stringliteral">"OpenNN Exception: Perceptron class.\n"</span> 
<a name="l00893"></a>00893                    &lt;&lt; <span class="stringliteral">"double calculate_activation_derivative(const double&amp;) const  method.\n"</span>
<a name="l00894"></a>00894                    &lt;&lt; <span class="stringliteral">"Threshold activation function is not derivable.\n"</span>;
<a name="l00895"></a>00895 
<a name="l00896"></a>00896             <span class="keywordflow">throw</span> std::logic_error(buffer.str());
<a name="l00897"></a>00897          }
<a name="l00898"></a>00898       }
<a name="l00899"></a>00899       <span class="keywordflow">break</span>;
<a name="l00900"></a>00900 
<a name="l00901"></a>00901       <span class="keywordflow">case</span> Perceptron::SymmetricThreshold:
<a name="l00902"></a>00902       {
<a name="l00903"></a>00903          <span class="keywordflow">if</span>(combination != 0.0)
<a name="l00904"></a>00904          {
<a name="l00905"></a>00905             <span class="keywordflow">return</span>(0.0); 
<a name="l00906"></a>00906          }
<a name="l00907"></a>00907          <span class="keywordflow">else</span>
<a name="l00908"></a>00908          {
<a name="l00909"></a>00909             std::ostringstream buffer;
<a name="l00910"></a>00910 
<a name="l00911"></a>00911             buffer &lt;&lt; <span class="stringliteral">"OpenNN Exception: Perceptron class.\n"</span> 
<a name="l00912"></a>00912                       &lt;&lt; <span class="stringliteral">"double calculate_activation_derivative(const double&amp;) const  method.\n"</span>
<a name="l00913"></a>00913                       &lt;&lt; <span class="stringliteral">"Symmetric threshold activation function is not derivable.\n"</span>;
<a name="l00914"></a>00914 
<a name="l00915"></a>00915             <span class="keywordflow">throw</span> std::logic_error(buffer.str());
<a name="l00916"></a>00916          }
<a name="l00917"></a>00917       }
<a name="l00918"></a>00918       <span class="keywordflow">break</span>;
<a name="l00919"></a>00919 
<a name="l00920"></a>00920       <span class="keywordflow">case</span> Perceptron::Linear:
<a name="l00921"></a>00921       {
<a name="l00922"></a>00922          <span class="keywordflow">return</span>(1.0);
<a name="l00923"></a>00923       }
<a name="l00924"></a>00924       <span class="keywordflow">break</span>;
<a name="l00925"></a>00925 
<a name="l00926"></a>00926       <span class="keywordflow">default</span>:
<a name="l00927"></a>00927       {
<a name="l00928"></a>00928          std::ostringstream buffer;
<a name="l00929"></a>00929 
<a name="l00930"></a>00930          buffer &lt;&lt; <span class="stringliteral">"OpenNN Exception: Perceptron class.\n"</span> 
<a name="l00931"></a>00931                 &lt;&lt; <span class="stringliteral">"double calculate_activation_derivative(const double&amp;) const  method.\n"</span>
<a name="l00932"></a>00932                 &lt;&lt; <span class="stringliteral">"Unknown activation function.\n"</span>;
<a name="l00933"></a>00933 
<a name="l00934"></a>00934          <span class="keywordflow">throw</span> std::logic_error(buffer.str());
<a name="l00935"></a>00935       }
<a name="l00936"></a>00936       <span class="keywordflow">break</span>;
<a name="l00937"></a>00937    }
<a name="l00938"></a>00938 }
<a name="l00939"></a>00939 
<a name="l00940"></a>00940 
<a name="l00941"></a>00941 <span class="comment">// double calculate_activation_second_derivative(const double&amp;) const  method</span>
<a name="l00942"></a>00942 
<a name="l00946"></a>00946 
<a name="l00947"></a><a class="code" href="class_open_n_n_1_1_perceptron.html#34358b8630a804c3c26a71bfdc99f72f">00947</a> <span class="keywordtype">double</span> <a class="code" href="class_open_n_n_1_1_perceptron.html#34358b8630a804c3c26a71bfdc99f72f">Perceptron::calculate_activation_second_derivative</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>&amp; combination)<span class="keyword"> const</span>
<a name="l00948"></a>00948 <span class="keyword"></span>{
<a name="l00949"></a>00949    <span class="keywordflow">switch</span>(activation_function)   
<a name="l00950"></a>00950    {
<a name="l00951"></a>00951       <span class="keywordflow">case</span> Perceptron::Logistic:
<a name="l00952"></a>00952       {
<a name="l00953"></a>00953          <span class="keyword">const</span> <span class="keywordtype">double</span> exponent = exp(combination);
<a name="l00954"></a>00954 
<a name="l00955"></a>00955          <span class="keywordflow">return</span>(-exponent*(exponent-1.0)/((exponent+1.0)*(exponent+1.0)*(exponent+1.0)));
<a name="l00956"></a>00956       }
<a name="l00957"></a>00957       <span class="keywordflow">break</span>;
<a name="l00958"></a>00958                                      
<a name="l00959"></a>00959       <span class="keywordflow">case</span> Perceptron::HyperbolicTangent:
<a name="l00960"></a>00960       {
<a name="l00961"></a>00961          <span class="keywordflow">return</span>(-2.0*tanh(combination)*(1.0 - pow(tanh(combination),2)));
<a name="l00962"></a>00962       }
<a name="l00963"></a>00963       <span class="keywordflow">break</span>;
<a name="l00964"></a>00964 
<a name="l00965"></a>00965       <span class="keywordflow">case</span> Perceptron::Threshold:
<a name="l00966"></a>00966       {
<a name="l00967"></a>00967          <span class="keywordflow">if</span>(combination != 0.0)
<a name="l00968"></a>00968          {
<a name="l00969"></a>00969             <span class="keywordflow">return</span>(0.0); 
<a name="l00970"></a>00970          }
<a name="l00971"></a>00971          <span class="keywordflow">else</span>
<a name="l00972"></a>00972          {
<a name="l00973"></a>00973             std::ostringstream buffer;
<a name="l00974"></a>00974 
<a name="l00975"></a>00975             buffer &lt;&lt; <span class="stringliteral">"OpenNN Exception: Perceptron class.\n"</span> 
<a name="l00976"></a>00976                    &lt;&lt; <span class="stringliteral">"double calculate_activation_second_derivative(const double&amp;) const  method.\n"</span>
<a name="l00977"></a>00977                    &lt;&lt; <span class="stringliteral">"Threshold activation function is not derivable.\n"</span>;
<a name="l00978"></a>00978 
<a name="l00979"></a>00979             <span class="keywordflow">throw</span> std::logic_error(buffer.str());
<a name="l00980"></a>00980          }
<a name="l00981"></a>00981       }
<a name="l00982"></a>00982       <span class="keywordflow">break</span>;
<a name="l00983"></a>00983 
<a name="l00984"></a>00984       <span class="keywordflow">case</span> Perceptron::SymmetricThreshold:
<a name="l00985"></a>00985       {
<a name="l00986"></a>00986          <span class="keywordflow">if</span>(combination != 0.0)
<a name="l00987"></a>00987          {
<a name="l00988"></a>00988             <span class="keywordflow">return</span>(0.0); 
<a name="l00989"></a>00989          }
<a name="l00990"></a>00990          <span class="keywordflow">else</span>
<a name="l00991"></a>00991          {
<a name="l00992"></a>00992             std::ostringstream buffer;
<a name="l00993"></a>00993 
<a name="l00994"></a>00994             buffer &lt;&lt; <span class="stringliteral">"OpenNN Exception: Perceptron class.\n"</span> 
<a name="l00995"></a>00995                    &lt;&lt; <span class="stringliteral">"double calculate_activation_second_derivative(const double&amp;) const  method.\n"</span>
<a name="l00996"></a>00996                    &lt;&lt; <span class="stringliteral">"Symmetric threshold activation function is not derivable.\n"</span>;
<a name="l00997"></a>00997 
<a name="l00998"></a>00998             <span class="keywordflow">throw</span> std::logic_error(buffer.str());
<a name="l00999"></a>00999          }
<a name="l01000"></a>01000       }
<a name="l01001"></a>01001       <span class="keywordflow">break</span>;
<a name="l01002"></a>01002 
<a name="l01003"></a>01003       <span class="keywordflow">case</span> Perceptron::Linear:
<a name="l01004"></a>01004       {
<a name="l01005"></a>01005          <span class="keywordflow">return</span>(0.0);        
<a name="l01006"></a>01006       }
<a name="l01007"></a>01007       <span class="keywordflow">break</span>;
<a name="l01008"></a>01008 
<a name="l01009"></a>01009       <span class="keywordflow">default</span>:
<a name="l01010"></a>01010       {
<a name="l01011"></a>01011          std::ostringstream buffer;
<a name="l01012"></a>01012 
<a name="l01013"></a>01013          buffer &lt;&lt; <span class="stringliteral">"OpenNN Exception: Perceptron class.\n"</span> 
<a name="l01014"></a>01014                 &lt;&lt; <span class="stringliteral">"double calculate_activation_second_derivative(const double&amp;) const  method.\n"</span>
<a name="l01015"></a>01015                 &lt;&lt; <span class="stringliteral">"Unknown activation function.\n"</span>;
<a name="l01016"></a>01016 
<a name="l01017"></a>01017          <span class="keywordflow">throw</span> std::logic_error(buffer.str());
<a name="l01018"></a>01018       }
<a name="l01019"></a>01019       <span class="keywordflow">break</span>;
<a name="l01020"></a>01020    }
<a name="l01021"></a>01021 }
<a name="l01022"></a>01022 
<a name="l01023"></a>01023 
<a name="l01024"></a>01024 <span class="comment">// double calculate_outputs(const Vector&lt;double&gt;&amp;) const method</span>
<a name="l01025"></a>01025 
<a name="l01029"></a>01029 
<a name="l01030"></a><a class="code" href="class_open_n_n_1_1_perceptron.html#bbfd27b69f5316cad61eb57cc168617e">01030</a> <span class="keywordtype">double</span> <a class="code" href="class_open_n_n_1_1_perceptron.html#bbfd27b69f5316cad61eb57cc168617e">Perceptron::calculate_outputs</a>(<span class="keyword">const</span> <a class="code" href="class_open_n_n_1_1_vector.html">Vector&lt;double&gt;</a>&amp; inputs)<span class="keyword"> const</span>
<a name="l01031"></a>01031 <span class="keyword"></span>{
<a name="l01032"></a>01032    <span class="comment">// Control sentence (if debug)</span>
<a name="l01033"></a>01033 
<a name="l01034"></a>01034 <span class="preprocessor">   #ifdef _DEBUG </span>
<a name="l01035"></a>01035 <span class="preprocessor"></span>
<a name="l01036"></a>01036    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> size = inputs.size();
<a name="l01037"></a>01037    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> inputs_number = <a class="code" href="class_open_n_n_1_1_perceptron.html#b41fa60d5a3c6903a739327274784e40" title="This method returns the number of inputs to the neuron.">count_inputs_number</a>();
<a name="l01038"></a>01038 
<a name="l01039"></a>01039    <span class="keywordflow">if</span>(size != inputs_number)
<a name="l01040"></a>01040    {
<a name="l01041"></a>01041       std::ostringstream buffer;
<a name="l01042"></a>01042 
<a name="l01043"></a>01043       buffer &lt;&lt; <span class="stringliteral">"OpenNN Exception: Perceptron class.\n"</span> 
<a name="l01044"></a>01044              &lt;&lt; <span class="stringliteral">"double calculate_outputs(const Vector&lt;double&gt;&amp;) const method.\n"</span>
<a name="l01045"></a>01045              &lt;&lt; <span class="stringliteral">"Size must be equal to number of inputs.\n"</span>;
<a name="l01046"></a>01046 
<a name="l01047"></a>01047       <span class="keywordflow">throw</span> std::logic_error(buffer.str());
<a name="l01048"></a>01048    }
<a name="l01049"></a>01049 
<a name="l01050"></a>01050 <span class="preprocessor">   #endif</span>
<a name="l01051"></a>01051 <span class="preprocessor"></span>
<a name="l01052"></a>01052    <span class="comment">// Calculate outputs </span>
<a name="l01053"></a>01053 
<a name="l01054"></a>01054    <span class="keywordflow">return</span>(<a class="code" href="class_open_n_n_1_1_perceptron.html#a50c102b421082a2a59c3b0678a62993">calculate_activation</a>(<a class="code" href="class_open_n_n_1_1_perceptron.html#c7fa457cc869606ac1d36c6edfaef3e7">calculate_combination</a>(inputs)));  
<a name="l01055"></a>01055 }
<a name="l01056"></a>01056 
<a name="l01057"></a>01057 
<a name="l01058"></a>01058 <span class="comment">// double calculate_parameters_output(const Vector&lt;double&gt;&amp;, const Vector&lt;double&gt;&amp;) const method</span>
<a name="l01059"></a>01059 
<a name="l01064"></a>01064 
<a name="l01065"></a><a class="code" href="class_open_n_n_1_1_perceptron.html#ba9b5c113426a1893089c470ade98f7d">01065</a> <span class="keywordtype">double</span> <a class="code" href="class_open_n_n_1_1_perceptron.html#ba9b5c113426a1893089c470ade98f7d">Perceptron::calculate_parameters_output</a>(<span class="keyword">const</span> <a class="code" href="class_open_n_n_1_1_vector.html">Vector&lt;double&gt;</a>&amp; inputs, <span class="keyword">const</span> <a class="code" href="class_open_n_n_1_1_vector.html">Vector&lt;double&gt;</a>&amp; parameters)<span class="keyword"> const</span>
<a name="l01066"></a>01066 <span class="keyword"></span>{
<a name="l01067"></a>01067    <span class="comment">// Control sentence (if debug)</span>
<a name="l01068"></a>01068 
<a name="l01069"></a>01069 <span class="preprocessor">   #ifdef _DEBUG </span>
<a name="l01070"></a>01070 <span class="preprocessor"></span>
<a name="l01071"></a>01071    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> inputs_size = inputs.size();
<a name="l01072"></a>01072    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> inputs_number = <a class="code" href="class_open_n_n_1_1_perceptron.html#b41fa60d5a3c6903a739327274784e40" title="This method returns the number of inputs to the neuron.">count_inputs_number</a>();
<a name="l01073"></a>01073 
<a name="l01074"></a>01074    <span class="keywordflow">if</span>(inputs_size != inputs_number)
<a name="l01075"></a>01075    {
<a name="l01076"></a>01076       std::ostringstream buffer;
<a name="l01077"></a>01077 
<a name="l01078"></a>01078       buffer &lt;&lt; <span class="stringliteral">"OpenNN Exception: Perceptron class.\n"</span> 
<a name="l01079"></a>01079              &lt;&lt; <span class="stringliteral">"double calculate_parameters_output(const Vector&lt;double&gt;&amp;, const Vector&lt;double&gt;&amp;) const method.\n"</span>
<a name="l01080"></a>01080              &lt;&lt; <span class="stringliteral">"Size of inputs must be equal to number of inputs.\n"</span>;
<a name="l01081"></a>01081 
<a name="l01082"></a>01082       <span class="keywordflow">throw</span> std::logic_error(buffer.str());
<a name="l01083"></a>01083    }
<a name="l01084"></a>01084 
<a name="l01085"></a>01085    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> parameters_size = parameters.size();
<a name="l01086"></a>01086 
<a name="l01087"></a>01087    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> parameters_number = <a class="code" href="class_open_n_n_1_1_perceptron.html#3d925e84360eef122af3b158e5884f15" title="This method returns the number of parameters (bias and synaptic weights) in the perceptron...">count_parameters_number</a>();
<a name="l01088"></a>01088 
<a name="l01089"></a>01089    <span class="keywordflow">if</span>(parameters_size != parameters_number)
<a name="l01090"></a>01090    {
<a name="l01091"></a>01091       std::ostringstream buffer;
<a name="l01092"></a>01092 
<a name="l01093"></a>01093       buffer &lt;&lt; <span class="stringliteral">"OpenNN Exception: Perceptron class.\n"</span> 
<a name="l01094"></a>01094              &lt;&lt; <span class="stringliteral">"double calculate_parameters_output(const Vector&lt;double&gt;&amp;, const Vector&lt;double&gt;&amp;) const method.\n"</span>
<a name="l01095"></a>01095              &lt;&lt; <span class="stringliteral">"Size of potential parameters ("</span> &lt;&lt; parameters_size &lt;&lt; <span class="stringliteral">") must be equal to number of parameters ("</span> &lt;&lt; parameters_number &lt;&lt; <span class="stringliteral">").\n"</span>;
<a name="l01096"></a>01096 
<a name="l01097"></a>01097       <span class="keywordflow">throw</span> std::logic_error(buffer.str());
<a name="l01098"></a>01098    }
<a name="l01099"></a>01099 
<a name="l01100"></a>01100 <span class="preprocessor">   #endif</span>
<a name="l01101"></a>01101 <span class="preprocessor"></span>
<a name="l01102"></a>01102    <a class="code" href="class_open_n_n_1_1_perceptron.html">Perceptron</a> copy(*<span class="keyword">this</span>);
<a name="l01103"></a>01103 
<a name="l01104"></a>01104    copy.<a class="code" href="class_open_n_n_1_1_perceptron.html#faf7f1580706aa95289f2c6a762bb189">set_parameters</a>(parameters);
<a name="l01105"></a>01105 
<a name="l01106"></a>01106    <span class="keywordflow">return</span>(copy.<a class="code" href="class_open_n_n_1_1_perceptron.html#bbfd27b69f5316cad61eb57cc168617e">calculate_outputs</a>(inputs));  
<a name="l01107"></a>01107 }
<a name="l01108"></a>01108 
<a name="l01109"></a>01109 
<a name="l01110"></a>01110 <span class="comment">// Vector&lt;double&gt; calculate_gradient(const Vector&lt;double&gt;&amp;) const method</span>
<a name="l01111"></a>01111 
<a name="l01114"></a>01114 
<a name="l01115"></a><a class="code" href="class_open_n_n_1_1_perceptron.html#dedfb9ca4993ed1ad36b58ea9d5116f2">01115</a> <a class="code" href="class_open_n_n_1_1_vector.html">Vector&lt;double&gt;</a> <a class="code" href="class_open_n_n_1_1_perceptron.html#dedfb9ca4993ed1ad36b58ea9d5116f2">Perceptron::calculate_gradient</a>(<span class="keyword">const</span> <a class="code" href="class_open_n_n_1_1_vector.html">Vector&lt;double&gt;</a>&amp; inputs)<span class="keyword"> const</span>
<a name="l01116"></a>01116 <span class="keyword"></span>{
<a name="l01117"></a>01117    <span class="comment">// Control sentence (if debug)</span>
<a name="l01118"></a>01118 
<a name="l01119"></a>01119 <span class="preprocessor">   #ifdef _DEBUG </span>
<a name="l01120"></a>01120 <span class="preprocessor"></span>
<a name="l01121"></a>01121    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> size = inputs.size();
<a name="l01122"></a>01122    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> inputs_number = <a class="code" href="class_open_n_n_1_1_perceptron.html#b41fa60d5a3c6903a739327274784e40" title="This method returns the number of inputs to the neuron.">count_inputs_number</a>();
<a name="l01123"></a>01123 
<a name="l01124"></a>01124    <span class="keywordflow">if</span>(size != inputs_number)
<a name="l01125"></a>01125    {
<a name="l01126"></a>01126       std::ostringstream buffer;
<a name="l01127"></a>01127 
<a name="l01128"></a>01128       buffer &lt;&lt; <span class="stringliteral">"OpenNN Exception: Perceptron class.\n"</span> 
<a name="l01129"></a>01129              &lt;&lt; <span class="stringliteral">"Vector&lt;double&gt; calculate_gradient(const Vector&lt;double&gt;&amp;) const method.\n"</span>
<a name="l01130"></a>01130              &lt;&lt; <span class="stringliteral">"Size must be equal to number of inputs.\n"</span>;
<a name="l01131"></a>01131 
<a name="l01132"></a>01132       <span class="keywordflow">throw</span> std::logic_error(buffer.str());
<a name="l01133"></a>01133    }
<a name="l01134"></a>01134 
<a name="l01135"></a>01135 <span class="preprocessor">   #endif</span>
<a name="l01136"></a>01136 <span class="preprocessor"></span>
<a name="l01137"></a>01137    <span class="comment">// Calculate gradient</span>
<a name="l01138"></a>01138 
<a name="l01139"></a>01139    <span class="keyword">const</span> <span class="keywordtype">double</span> combination = <a class="code" href="class_open_n_n_1_1_perceptron.html#c7fa457cc869606ac1d36c6edfaef3e7">calculate_combination</a>(inputs);
<a name="l01140"></a>01140 
<a name="l01141"></a>01141    <span class="keyword">const</span> <span class="keywordtype">double</span> activation_derivative = <a class="code" href="class_open_n_n_1_1_perceptron.html#7f75c848df5783623ea50d7da6abd894">calculate_activation_derivative</a>(combination);
<a name="l01142"></a>01142 
<a name="l01143"></a>01143    <span class="keywordflow">return</span>(synaptic_weights*activation_derivative);
<a name="l01144"></a>01144 }
<a name="l01145"></a>01145 
<a name="l01146"></a>01146 
<a name="l01147"></a>01147 <span class="comment">// Vector&lt;double&gt; calculate_parameters_gradient(const Vector&lt;double&gt;&amp;) const method</span>
<a name="l01148"></a>01148 
<a name="l01151"></a>01151 
<a name="l01152"></a><a class="code" href="class_open_n_n_1_1_perceptron.html#19e9ed40073a3694994e90bd6fd4dc97">01152</a> <a class="code" href="class_open_n_n_1_1_vector.html">Vector&lt;double&gt;</a> <a class="code" href="class_open_n_n_1_1_perceptron.html#19e9ed40073a3694994e90bd6fd4dc97">Perceptron::calculate_parameters_gradient</a>(<span class="keyword">const</span> <a class="code" href="class_open_n_n_1_1_vector.html">Vector&lt;double&gt;</a>&amp; inputs)<span class="keyword"> const</span>
<a name="l01153"></a>01153 <span class="keyword"></span>{
<a name="l01154"></a>01154    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> inputs_number = <a class="code" href="class_open_n_n_1_1_perceptron.html#b41fa60d5a3c6903a739327274784e40" title="This method returns the number of inputs to the neuron.">count_inputs_number</a>();
<a name="l01155"></a>01155 
<a name="l01156"></a>01156    <span class="comment">// Control sentence (if debug)</span>
<a name="l01157"></a>01157 
<a name="l01158"></a>01158 <span class="preprocessor">   #ifdef _DEBUG </span>
<a name="l01159"></a>01159 <span class="preprocessor"></span>
<a name="l01160"></a>01160    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> size = inputs.size();
<a name="l01161"></a>01161 
<a name="l01162"></a>01162    <span class="keywordflow">if</span>(size != inputs_number)
<a name="l01163"></a>01163    {
<a name="l01164"></a>01164       std::ostringstream buffer;
<a name="l01165"></a>01165 
<a name="l01166"></a>01166       buffer &lt;&lt; <span class="stringliteral">"OpenNN Exception: Perceptron class.\n"</span> 
<a name="l01167"></a>01167              &lt;&lt; <span class="stringliteral">"double calculate_parameters_gradient(const Vector&lt;double&gt;&amp;) const method.\n"</span>
<a name="l01168"></a>01168              &lt;&lt; <span class="stringliteral">"Size must be equal to number of inputs.\n"</span>;
<a name="l01169"></a>01169 
<a name="l01170"></a>01170       <span class="keywordflow">throw</span> std::logic_error(buffer.str());
<a name="l01171"></a>01171    }
<a name="l01172"></a>01172 
<a name="l01173"></a>01173 <span class="preprocessor">   #endif</span>
<a name="l01174"></a>01174 <span class="preprocessor"></span>
<a name="l01175"></a>01175    <span class="comment">// Calculate parameters gradient</span>
<a name="l01176"></a>01176 
<a name="l01177"></a>01177    <span class="keyword">const</span> <span class="keywordtype">double</span> combination = <a class="code" href="class_open_n_n_1_1_perceptron.html#c7fa457cc869606ac1d36c6edfaef3e7">calculate_combination</a>(inputs);
<a name="l01178"></a>01178 
<a name="l01179"></a>01179    <span class="keyword">const</span> <span class="keywordtype">double</span> activation_derivative = <a class="code" href="class_open_n_n_1_1_perceptron.html#7f75c848df5783623ea50d7da6abd894">calculate_activation_derivative</a>(combination);
<a name="l01180"></a>01180 
<a name="l01181"></a>01181    <a class="code" href="class_open_n_n_1_1_vector.html">Vector&lt;double&gt;</a> parameters_gradient(1+inputs_number);
<a name="l01182"></a>01182 
<a name="l01183"></a>01183    <span class="comment">// Bias</span>
<a name="l01184"></a>01184 
<a name="l01185"></a>01185    parameters_gradient[0] = activation_derivative;
<a name="l01186"></a>01186 
<a name="l01187"></a>01187    <span class="comment">// Synaptic weights</span>
<a name="l01188"></a>01188 
<a name="l01189"></a>01189    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 1; i &lt; 1+inputs_number; i++)
<a name="l01190"></a>01190    {
<a name="l01191"></a>01191       parameters_gradient[i] = inputs[i-1]*activation_derivative;
<a name="l01192"></a>01192    }
<a name="l01193"></a>01193 
<a name="l01194"></a>01194    <span class="keywordflow">return</span>(parameters_gradient);
<a name="l01195"></a>01195 }
<a name="l01196"></a>01196 
<a name="l01197"></a>01197 
<a name="l01198"></a>01198 <span class="comment">// Vector&lt;double&gt; calculate_combination_gradient(const Vector&lt;double&gt;&amp;) const method</span>
<a name="l01199"></a>01199 
<a name="l01201"></a>01201 
<a name="l01202"></a><a class="code" href="class_open_n_n_1_1_perceptron.html#fa627e2928a2a66306a9bd4b1b3c5fa1">01202</a> <a class="code" href="class_open_n_n_1_1_vector.html">Vector&lt;double&gt;</a> <a class="code" href="class_open_n_n_1_1_perceptron.html#fa627e2928a2a66306a9bd4b1b3c5fa1" title="This method returns the partial derivatives of the combination with respect to the...">Perceptron::calculate_combination_gradient</a>(<span class="keyword">const</span> <a class="code" href="class_open_n_n_1_1_vector.html">Vector&lt;double&gt;</a>&amp;)<span class="keyword"> const</span>
<a name="l01203"></a>01203 <span class="keyword"></span>{
<a name="l01204"></a>01204    <span class="keywordflow">return</span>(synaptic_weights);
<a name="l01205"></a>01205 }
<a name="l01206"></a>01206 
<a name="l01207"></a>01207 
<a name="l01208"></a>01208 <span class="comment">// Vector&lt;double&gt; calculate_combination_parameters_gradient(const Vector&lt;double&gt;&amp;) const method</span>
<a name="l01209"></a>01209 
<a name="l01212"></a>01212 
<a name="l01213"></a><a class="code" href="class_open_n_n_1_1_perceptron.html#d73c63467f7b0da6c622dd2fc029e070">01213</a> <a class="code" href="class_open_n_n_1_1_vector.html">Vector&lt;double&gt;</a> <a class="code" href="class_open_n_n_1_1_perceptron.html#d73c63467f7b0da6c622dd2fc029e070">Perceptron::calculate_combination_parameters_gradient</a>(<span class="keyword">const</span> <a class="code" href="class_open_n_n_1_1_vector.html">Vector&lt;double&gt;</a>&amp; inputs)<span class="keyword"> const</span>
<a name="l01214"></a>01214 <span class="keyword"></span>{   
<a name="l01215"></a>01215    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> inputs_number = <a class="code" href="class_open_n_n_1_1_perceptron.html#b41fa60d5a3c6903a739327274784e40" title="This method returns the number of inputs to the neuron.">count_inputs_number</a>();
<a name="l01216"></a>01216 
<a name="l01217"></a>01217    <span class="comment">// Control sentence (if debug)</span>
<a name="l01218"></a>01218 
<a name="l01219"></a>01219 <span class="preprocessor">   #ifdef _DEBUG </span>
<a name="l01220"></a>01220 <span class="preprocessor"></span>
<a name="l01221"></a>01221    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> size = inputs.size();
<a name="l01222"></a>01222 
<a name="l01223"></a>01223    <span class="keywordflow">if</span>(size != inputs_number)
<a name="l01224"></a>01224    {
<a name="l01225"></a>01225       std::ostringstream buffer;
<a name="l01226"></a>01226 
<a name="l01227"></a>01227       buffer &lt;&lt; <span class="stringliteral">"OpenNN Exception: Perceptron class.\n"</span> 
<a name="l01228"></a>01228              &lt;&lt; <span class="stringliteral">"double calculate_combination_parameters_gradient(const Vector&lt;double&gt;&amp;) const method.\n"</span>
<a name="l01229"></a>01229              &lt;&lt; <span class="stringliteral">"Size must be equal to number of inputs.\n"</span>;
<a name="l01230"></a>01230 
<a name="l01231"></a>01231       <span class="keywordflow">throw</span> std::logic_error(buffer.str());
<a name="l01232"></a>01232    }
<a name="l01233"></a>01233 
<a name="l01234"></a>01234 <span class="preprocessor">   #endif</span>
<a name="l01235"></a>01235 <span class="preprocessor"></span>
<a name="l01236"></a>01236    <span class="comment">// Calculate combination gradient parameters</span>
<a name="l01237"></a>01237 
<a name="l01238"></a>01238    <a class="code" href="class_open_n_n_1_1_vector.html">Vector&lt;double&gt;</a> combination_parameters_gradient(1+inputs_number);
<a name="l01239"></a>01239 
<a name="l01240"></a>01240    <span class="comment">// Bias</span>
<a name="l01241"></a>01241 
<a name="l01242"></a>01242    combination_parameters_gradient[0] = 1.0;
<a name="l01243"></a>01243 
<a name="l01244"></a>01244    <span class="comment">// Synaptic weights</span>
<a name="l01245"></a>01245 
<a name="l01246"></a>01246    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 1; i &lt; 1+inputs_number; i++)
<a name="l01247"></a>01247    {
<a name="l01248"></a>01248       combination_parameters_gradient[i] = inputs[i-1];
<a name="l01249"></a>01249    }
<a name="l01250"></a>01250 
<a name="l01251"></a>01251    <span class="keywordflow">return</span>(combination_parameters_gradient);
<a name="l01252"></a>01252 }
<a name="l01253"></a>01253 
<a name="l01254"></a>01254 
<a name="l01255"></a>01255 <span class="comment">// Matrix&lt;double&gt; calculate_Hessian(const Vector&lt;double&gt;&amp;) const method</span>
<a name="l01256"></a>01256 
<a name="l01259"></a>01259 
<a name="l01260"></a><a class="code" href="class_open_n_n_1_1_perceptron.html#6f0283ca5ea9e7bd5d051aab964fbcb8">01260</a> <a class="code" href="class_open_n_n_1_1_matrix.html">Matrix&lt;double&gt;</a> <a class="code" href="class_open_n_n_1_1_perceptron.html#6f0283ca5ea9e7bd5d051aab964fbcb8">Perceptron::calculate_Hessian</a>(<span class="keyword">const</span> <a class="code" href="class_open_n_n_1_1_vector.html">Vector&lt;double&gt;</a>&amp; inputs)<span class="keyword"> const</span>
<a name="l01261"></a>01261 <span class="keyword"></span>{   
<a name="l01262"></a>01262    <span class="comment">// Control sentence (if debug)</span>
<a name="l01263"></a>01263 
<a name="l01264"></a>01264 <span class="preprocessor">   #ifdef _DEBUG </span>
<a name="l01265"></a>01265 <span class="preprocessor"></span>
<a name="l01266"></a>01266    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> inputs_number = <a class="code" href="class_open_n_n_1_1_perceptron.html#b41fa60d5a3c6903a739327274784e40" title="This method returns the number of inputs to the neuron.">count_inputs_number</a>();
<a name="l01267"></a>01267    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> inputs_size = inputs.size();
<a name="l01268"></a>01268 
<a name="l01269"></a>01269    <span class="keywordflow">if</span>(inputs_size != inputs_number)
<a name="l01270"></a>01270    {
<a name="l01271"></a>01271       std::ostringstream buffer;
<a name="l01272"></a>01272 
<a name="l01273"></a>01273       buffer &lt;&lt; <span class="stringliteral">"OpenNN Exception: Perceptron class.\n"</span> 
<a name="l01274"></a>01274              &lt;&lt; <span class="stringliteral">"Matrix&lt;double&gt; calculate_Hessian(const Vector&lt;double&gt;&amp;, const Vector&lt;double&gt;&amp;) const method.\n"</span>
<a name="l01275"></a>01275              &lt;&lt; <span class="stringliteral">"Size of inputs must be equal to number of inputs.\n"</span>;
<a name="l01276"></a>01276 
<a name="l01277"></a>01277       <span class="keywordflow">throw</span> std::logic_error(buffer.str());
<a name="l01278"></a>01278    }
<a name="l01279"></a>01279 
<a name="l01280"></a>01280 <span class="preprocessor">   #endif</span>
<a name="l01281"></a>01281 <span class="preprocessor"></span>
<a name="l01282"></a>01282    <span class="keyword">const</span> <span class="keywordtype">double</span> combination = <a class="code" href="class_open_n_n_1_1_perceptron.html#c7fa457cc869606ac1d36c6edfaef3e7">calculate_combination</a>(inputs);
<a name="l01283"></a>01283    <span class="keyword">const</span> <span class="keywordtype">double</span> activation_second_derivative = <a class="code" href="class_open_n_n_1_1_perceptron.html#34358b8630a804c3c26a71bfdc99f72f">calculate_activation_second_derivative</a>(combination);
<a name="l01284"></a>01284 
<a name="l01285"></a>01285    <span class="keywordflow">return</span>(synaptic_weights.<a class="code" href="class_open_n_n_1_1_vector.html#00d2deaa37d50750f209fae736692676">direct</a>(synaptic_weights)*activation_second_derivative);
<a name="l01286"></a>01286 }
<a name="l01287"></a>01287 
<a name="l01288"></a>01288 
<a name="l01289"></a>01289 <span class="comment">// Matrix&lt;double&gt; calculate_parameters_Hessian(const Vector&lt;double&gt;&amp;) const method</span>
<a name="l01290"></a>01290 
<a name="l01293"></a>01293 
<a name="l01294"></a><a class="code" href="class_open_n_n_1_1_perceptron.html#7491a15e304dd31597dfbbfd653c84d9">01294</a> <a class="code" href="class_open_n_n_1_1_matrix.html">Matrix&lt;double&gt;</a> <a class="code" href="class_open_n_n_1_1_perceptron.html#7491a15e304dd31597dfbbfd653c84d9">Perceptron::calculate_parameters_Hessian</a>(<span class="keyword">const</span> <a class="code" href="class_open_n_n_1_1_vector.html">Vector&lt;double&gt;</a>&amp; inputs)<span class="keyword"> const</span>
<a name="l01295"></a>01295 <span class="keyword"></span>{
<a name="l01296"></a>01296    <span class="comment">// Control sentence (if debug)</span>
<a name="l01297"></a>01297 
<a name="l01298"></a>01298 <span class="preprocessor">   #ifdef _DEBUG </span>
<a name="l01299"></a>01299 <span class="preprocessor"></span>
<a name="l01300"></a>01300    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> inputs_size = inputs.size();
<a name="l01301"></a>01301    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> inputs_number = <a class="code" href="class_open_n_n_1_1_perceptron.html#b41fa60d5a3c6903a739327274784e40" title="This method returns the number of inputs to the neuron.">count_inputs_number</a>();
<a name="l01302"></a>01302 
<a name="l01303"></a>01303    <span class="keywordflow">if</span>(inputs_size != inputs_number)
<a name="l01304"></a>01304    {
<a name="l01305"></a>01305       std::ostringstream buffer;
<a name="l01306"></a>01306 
<a name="l01307"></a>01307       buffer &lt;&lt; <span class="stringliteral">"OpenNN Exception: Perceptron class.\n"</span> 
<a name="l01308"></a>01308              &lt;&lt; <span class="stringliteral">"Matrix&lt;double&gt; calculate_parameters_Hessian(const Vector&lt;double&gt;&amp;) const method.\n"</span>
<a name="l01309"></a>01309              &lt;&lt; <span class="stringliteral">"Size of inputs must be equal to number of inputs.\n"</span>;
<a name="l01310"></a>01310 
<a name="l01311"></a>01311       <span class="keywordflow">throw</span> std::logic_error(buffer.str());
<a name="l01312"></a>01312    }
<a name="l01313"></a>01313 
<a name="l01314"></a>01314 <span class="preprocessor">   #endif</span>
<a name="l01315"></a>01315 <span class="preprocessor"></span>
<a name="l01316"></a>01316    <span class="keyword">const</span> <span class="keywordtype">double</span> combination = <a class="code" href="class_open_n_n_1_1_perceptron.html#c7fa457cc869606ac1d36c6edfaef3e7">calculate_combination</a>(inputs);
<a name="l01317"></a>01317    <span class="keyword">const</span> <span class="keywordtype">double</span> activation_second_derivative = <a class="code" href="class_open_n_n_1_1_perceptron.html#34358b8630a804c3c26a71bfdc99f72f">calculate_activation_second_derivative</a>(combination);
<a name="l01318"></a>01318 
<a name="l01319"></a>01319    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> parameters_number = <a class="code" href="class_open_n_n_1_1_perceptron.html#3d925e84360eef122af3b158e5884f15" title="This method returns the number of parameters (bias and synaptic weights) in the perceptron...">count_parameters_number</a>();
<a name="l01320"></a>01320 
<a name="l01321"></a>01321    <a class="code" href="class_open_n_n_1_1_matrix.html">Matrix&lt;double&gt;</a> parameters_Hessian(parameters_number, parameters_number);
<a name="l01322"></a>01322 
<a name="l01323"></a>01323    <span class="comment">// Bias - bias derivative</span>
<a name="l01324"></a>01324 
<a name="l01325"></a>01325    parameters_Hessian[0][0] = activation_second_derivative;
<a name="l01326"></a>01326 
<a name="l01327"></a>01327    <span class="comment">// Bias - synaptic weight derivative</span>
<a name="l01328"></a>01328 
<a name="l01329"></a>01329    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 1; i &lt; parameters_number; i++)
<a name="l01330"></a>01330    {
<a name="l01331"></a>01331       parameters_Hessian[0][i] = activation_second_derivative*inputs[i-1];
<a name="l01332"></a>01332    }
<a name="l01333"></a>01333 
<a name="l01334"></a>01334    <span class="comment">// Synaptic weight -synaptic weight derivative</span>
<a name="l01335"></a>01335 
<a name="l01336"></a>01336    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 1; i &lt; parameters_number; i++)
<a name="l01337"></a>01337    {
<a name="l01338"></a>01338       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 1; j &lt; parameters_number; j++)
<a name="l01339"></a>01339       {
<a name="l01340"></a>01340          parameters_Hessian[i][j] = activation_second_derivative*inputs[i-1]*inputs[j-1];
<a name="l01341"></a>01341       }
<a name="l01342"></a>01342    }
<a name="l01343"></a>01343 
<a name="l01344"></a>01344    <span class="comment">// Hessian symmetry</span>
<a name="l01345"></a>01345 
<a name="l01346"></a>01346    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; parameters_number; i++)
<a name="l01347"></a>01347    {
<a name="l01348"></a>01348       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; i; j++)
<a name="l01349"></a>01349       {
<a name="l01350"></a>01350          parameters_Hessian[i][j] = parameters_Hessian[j][i];
<a name="l01351"></a>01351       }
<a name="l01352"></a>01352    }
<a name="l01353"></a>01353    
<a name="l01354"></a>01354    <span class="keywordflow">return</span>(parameters_Hessian);   
<a name="l01355"></a>01355 }
<a name="l01356"></a>01356 
<a name="l01357"></a>01357 
<a name="l01358"></a>01358 <span class="comment">// Matrix&lt;double&gt; calculate_combination_Hessian(const Vector&lt;double&gt;&amp;) const method</span>
<a name="l01359"></a>01359 
<a name="l01361"></a>01361 
<a name="l01362"></a><a class="code" href="class_open_n_n_1_1_perceptron.html#87a546d2311eb4e2a36779ec45606bf0">01362</a> <a class="code" href="class_open_n_n_1_1_matrix.html">Matrix&lt;double&gt;</a> <a class="code" href="class_open_n_n_1_1_perceptron.html#87a546d2311eb4e2a36779ec45606bf0" title="This method retuns the second derivatives of the combination with respect to the...">Perceptron::calculate_combination_Hessian</a>(<span class="keyword">const</span> <a class="code" href="class_open_n_n_1_1_vector.html">Vector&lt;double&gt;</a>&amp;)<span class="keyword"> const</span>
<a name="l01363"></a>01363 <span class="keyword"></span>{
<a name="l01364"></a>01364    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> inputs_number = <a class="code" href="class_open_n_n_1_1_perceptron.html#b41fa60d5a3c6903a739327274784e40" title="This method returns the number of inputs to the neuron.">count_inputs_number</a>();
<a name="l01365"></a>01365 
<a name="l01366"></a>01366    <span class="keyword">const</span> <a class="code" href="class_open_n_n_1_1_matrix.html">Matrix&lt;double&gt;</a> combination_Hessian(inputs_number, inputs_number, 0.0); 
<a name="l01367"></a>01367 
<a name="l01368"></a>01368    <span class="keywordflow">return</span>(combination_Hessian);   
<a name="l01369"></a>01369 }
<a name="l01370"></a>01370 
<a name="l01371"></a>01371 
<a name="l01372"></a>01372 <span class="comment">// Matrix&lt;double&gt; calculate_combination_parameters_Hessian(const Vector&lt;double&gt;&amp;) const method</span>
<a name="l01373"></a>01373 
<a name="l01375"></a>01375 
<a name="l01376"></a><a class="code" href="class_open_n_n_1_1_perceptron.html#500abf2952d6cb3bb79c031d7bea38ab">01376</a> <a class="code" href="class_open_n_n_1_1_matrix.html">Matrix&lt;double&gt;</a> <a class="code" href="class_open_n_n_1_1_perceptron.html#500abf2952d6cb3bb79c031d7bea38ab" title="This method retuns the second derivatives of the combination with respect to the...">Perceptron::calculate_combination_parameters_Hessian</a>(<span class="keyword">const</span> <a class="code" href="class_open_n_n_1_1_vector.html">Vector&lt;double&gt;</a>&amp;)<span class="keyword"> const</span>
<a name="l01377"></a>01377 <span class="keyword"></span>{
<a name="l01378"></a>01378    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> parameters_number = <a class="code" href="class_open_n_n_1_1_perceptron.html#3d925e84360eef122af3b158e5884f15" title="This method returns the number of parameters (bias and synaptic weights) in the perceptron...">count_parameters_number</a>();
<a name="l01379"></a>01379 
<a name="l01380"></a>01380    <span class="keyword">const</span> <a class="code" href="class_open_n_n_1_1_matrix.html">Matrix&lt;double&gt;</a> Hessian(parameters_number, parameters_number, 0.0);
<a name="l01381"></a>01381 
<a name="l01382"></a>01382    <span class="keywordflow">return</span>(Hessian);   
<a name="l01383"></a>01383 }
<a name="l01384"></a>01384 
<a name="l01385"></a>01385 
<a name="l01386"></a>01386 <span class="comment">// void grow_input(void) method</span>
<a name="l01387"></a>01387 
<a name="l01390"></a>01390 
<a name="l01391"></a><a class="code" href="class_open_n_n_1_1_perceptron.html#7faab78a5622ae10266362ea34abe242">01391</a> <span class="keywordtype">void</span> <a class="code" href="class_open_n_n_1_1_perceptron.html#7faab78a5622ae10266362ea34abe242">Perceptron::grow_input</a>(<span class="keywordtype">void</span>)
<a name="l01392"></a>01392 {
<a name="l01393"></a>01393    synaptic_weights.push_back(0.0);
<a name="l01394"></a>01394 }
<a name="l01395"></a>01395 
<a name="l01396"></a>01396 
<a name="l01397"></a>01397 <span class="comment">// void prune_input(const unsigned int&amp;) method</span>
<a name="l01398"></a>01398 
<a name="l01401"></a>01401 
<a name="l01402"></a><a class="code" href="class_open_n_n_1_1_perceptron.html#9a244664da7e53b819699f75a2cfd093">01402</a> <span class="keywordtype">void</span> <a class="code" href="class_open_n_n_1_1_perceptron.html#9a244664da7e53b819699f75a2cfd093">Perceptron::prune_input</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&amp; index)
<a name="l01403"></a>01403 {
<a name="l01404"></a>01404    synaptic_weights.erase(synaptic_weights.begin()+index-1);
<a name="l01405"></a>01405 }
<a name="l01406"></a>01406 
<a name="l01407"></a>01407 
<a name="l01408"></a>01408 <span class="comment">// std::string write_expression(const Vector&lt;std::string&gt;&amp;, const std::string&amp;) const method</span>
<a name="l01409"></a>01409 
<a name="l01413"></a>01413 
<a name="l01414"></a><a class="code" href="class_open_n_n_1_1_perceptron.html#84ca41048b1a2607f6c73934a79c8666">01414</a> std::string <a class="code" href="class_open_n_n_1_1_perceptron.html#84ca41048b1a2607f6c73934a79c8666">Perceptron::write_expression</a>(<span class="keyword">const</span> <a class="code" href="class_open_n_n_1_1_vector.html">Vector&lt;std::string&gt;</a>&amp; inputs_name, <span class="keyword">const</span> std::string&amp; output_name)<span class="keyword"> const</span>
<a name="l01415"></a>01415 <span class="keyword"></span>{
<a name="l01416"></a>01416    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> inputs_number = <a class="code" href="class_open_n_n_1_1_perceptron.html#b41fa60d5a3c6903a739327274784e40" title="This method returns the number of inputs to the neuron.">count_inputs_number</a>();
<a name="l01417"></a>01417 
<a name="l01418"></a>01418    std::string activation_function_name = <a class="code" href="class_open_n_n_1_1_perceptron.html#caa09313a43f0271a9ade7ec36a55a37" title="This method returns a string with the name of the activation function of the neuron...">write_activation_function</a>();
<a name="l01419"></a>01419 
<a name="l01420"></a>01420    std::ostringstream buffer;
<a name="l01421"></a>01421 
<a name="l01422"></a>01422    buffer &lt;&lt; output_name &lt;&lt; <span class="stringliteral">"="</span> &lt;&lt; activation_function_name &lt;&lt; <span class="stringliteral">"("</span>
<a name="l01423"></a>01423           &lt;&lt; bias;
<a name="l01424"></a>01424 
<a name="l01425"></a>01425    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; inputs_number; i++)
<a name="l01426"></a>01426    {
<a name="l01427"></a>01427       <span class="keywordflow">if</span>(synaptic_weights[i] &gt;= 0)
<a name="l01428"></a>01428       {
<a name="l01429"></a>01429          buffer &lt;&lt; <span class="stringliteral">"+"</span>;      
<a name="l01430"></a>01430       }
<a name="l01431"></a>01431 
<a name="l01432"></a>01432       buffer &lt;&lt; synaptic_weights[i] &lt;&lt; <span class="stringliteral">"*"</span> &lt;&lt; inputs_name[i];
<a name="l01433"></a>01433    }
<a name="l01434"></a>01434 
<a name="l01435"></a>01435    buffer &lt;&lt; <span class="stringliteral">");\n"</span>;
<a name="l01436"></a>01436 
<a name="l01437"></a>01437    <span class="keywordflow">return</span>(buffer.str());
<a name="l01438"></a>01438 }
<a name="l01439"></a>01439 
<a name="l01440"></a>01440 
<a name="l01441"></a>01441 <span class="comment">// double calculate_random_uniform(const double&amp;, const double&amp;)const  method</span>
<a name="l01442"></a>01442 
<a name="l01446"></a>01446 
<a name="l01447"></a>01447 <span class="keywordtype">double</span> Perceptron::calculate_random_uniform(<span class="keyword">const</span> <span class="keywordtype">double</span>&amp; minimum, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; maximum)<span class="keyword"> const </span>
<a name="l01448"></a>01448 <span class="keyword"></span>{
<a name="l01449"></a>01449    <span class="keyword">const</span> <span class="keywordtype">double</span> random = (double)rand()/(RAND_MAX+1.0);
<a name="l01450"></a>01450 
<a name="l01451"></a>01451    <span class="keyword">const</span> <span class="keywordtype">double</span> random_uniform = minimum + (maximum-minimum)*random;
<a name="l01452"></a>01452 
<a name="l01453"></a>01453    <span class="keywordflow">return</span>(random_uniform);
<a name="l01454"></a>01454 }
<a name="l01455"></a>01455 
<a name="l01456"></a>01456 
<a name="l01457"></a>01457 <span class="comment">// double calculate_random_normal(const double&amp;, const double&amp;) const method</span>
<a name="l01458"></a>01458 
<a name="l01462"></a>01462 
<a name="l01463"></a>01463 <span class="keywordtype">double</span> Perceptron::calculate_random_normal(<span class="keyword">const</span> <span class="keywordtype">double</span>&amp; mean, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; standard_deviation)<span class="keyword"> const </span>
<a name="l01464"></a>01464 <span class="keyword"></span>{
<a name="l01465"></a>01465    <span class="keywordtype">double</span> random_uniform_1;
<a name="l01466"></a>01466 
<a name="l01467"></a>01467    <span class="keywordflow">do</span>
<a name="l01468"></a>01468    {
<a name="l01469"></a>01469       random_uniform_1 = (double)rand()/(RAND_MAX+1.0);
<a name="l01470"></a>01470 
<a name="l01471"></a>01471    }<span class="keywordflow">while</span>(random_uniform_1 == 0.0);
<a name="l01472"></a>01472 
<a name="l01473"></a>01473    <span class="keyword">const</span> <span class="keywordtype">double</span> random_uniform_2 = (double)rand()/(RAND_MAX+1.0);
<a name="l01474"></a>01474 
<a name="l01475"></a>01475    <span class="comment">// Box-Muller transformation</span>
<a name="l01476"></a>01476 
<a name="l01477"></a>01477    <span class="keyword">const</span> <span class="keywordtype">double</span> pi = 4.0*atan(1.0);
<a name="l01478"></a>01478 
<a name="l01479"></a>01479    <span class="keyword">const</span> <span class="keywordtype">double</span> random_normal = mean + sqrt(-2.0*log(random_uniform_1))*sin(2.0*pi*random_uniform_2)*standard_deviation;
<a name="l01480"></a>01480 
<a name="l01481"></a>01481    <span class="keywordflow">return</span>(random_normal);
<a name="l01482"></a>01482 }
<a name="l01483"></a>01483 
<a name="l01484"></a>01484 }
<a name="l01485"></a>01485 
<a name="l01486"></a>01486 
<a name="l01487"></a>01487 <span class="comment">// OpenNN: Open Neural Networks Library.</span>
<a name="l01488"></a>01488 <span class="comment">// Copyright (C) 2005-2012 Roberto Lopez </span>
<a name="l01489"></a>01489 <span class="comment">//</span>
<a name="l01490"></a>01490 <span class="comment">// This library is free software; you can redistribute it and/or</span>
<a name="l01491"></a>01491 <span class="comment">// modify it under the terms of the GNU Lesser General Public</span>
<a name="l01492"></a>01492 <span class="comment">// License as published by the Free Software Foundation; either</span>
<a name="l01493"></a>01493 <span class="comment">// version 2.1 of the License, or any later version.</span>
<a name="l01494"></a>01494 <span class="comment">//</span>
<a name="l01495"></a>01495 <span class="comment">// This library is distributed in the hope that it will be useful,</span>
<a name="l01496"></a>01496 <span class="comment">// but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l01497"></a>01497 <span class="comment">// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span>
<a name="l01498"></a>01498 <span class="comment">// Lesser General Public License for more details.</span>
<a name="l01499"></a>01499 
<a name="l01500"></a>01500 <span class="comment">// You should have received a copy of the GNU Lesser General Public</span>
<a name="l01501"></a>01501 <span class="comment">// License along with this library; if not, write to the Free Software</span>
<a name="l01502"></a>01502 <span class="comment">// Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA</span>
<a name="l01503"></a>01503 
</pre></div></div>
<hr size="1"><address style="text-align: right;"><small>Generated on Sun Aug 26 11:58:13 2012 for OpenNN by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.9 </small></address>
</body>
</html>
